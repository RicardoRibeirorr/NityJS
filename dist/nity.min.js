var Nity=(()=>{var A=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames;var pt=Object.prototype.hasOwnProperty;var l=(i,t)=>A(i,"name",{value:t,configurable:!0});var ut=(i,t)=>{for(var e in t)A(i,e,{get:t[e],enumerable:!0})},mt=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of dt(t))!pt.call(i,o)&&o!==e&&A(i,o,{get:()=>t[o],enumerable:!(s=ct(t,o))||s.enumerable});return i};var ft=i=>mt(A({},"__esModule",{value:!0}),i);var gt={};ut(gt,{BoxColliderComponent:()=>et,CameraComponent:()=>R,CircleColliderComponent:()=>K,Component:()=>f,FollowTarget:()=>ot,Game:()=>C,GameObject:()=>z,ImageComponent:()=>_,Input:()=>w,Instantiate:()=>P,MovementComponent:()=>U,MovementController:()=>Z,Random:()=>st,RigidbodyComponent:()=>I,Scene:()=>H,ShapeComponent:()=>tt,Sprite:()=>J,SpriteAnimationClip:()=>W,SpriteAnimationComponent:()=>N,SpriteAsset:()=>Q,SpriteRegistry:()=>S,SpriteRendererComponent:()=>G,SpritesheetAsset:()=>V,Time:()=>x,Vector2:()=>g,Vector3:()=>it});var S=class{static{l(this,"SpriteRegistry")}static sprites=new Map;static spritesheets=new Map;static _addSprite(t,e){this.sprites.set(t,e)}static _addSpritesheet(t,e){this.spritesheets.set(t,e)}static getSprite(t){return this.sprites.get(t)||null}static getSpritesheet(t){return this.spritesheets.get(t)||null}static async preloadAll(){let t=Array.from(this.sprites.values()).filter(s=>s.load&&typeof s.load=="function").map(s=>s.isLoaded?Promise.resolve():s.load()),e=Array.from(this.spritesheets.values()).map(s=>s.isLoaded?Promise.resolve():s.load());await Promise.all([...t,...e])}static hasSprite(t){return this.sprites.has(t)}static hasSpritesheet(t){return this.spritesheets.has(t)}static getSpriteNames(){return Array.from(this.sprites.keys())}static getSpritesheetNames(){return Array.from(this.spritesheets.keys())}static getSpritesFromSheet(t){let e=[];for(let s of this.sprites.keys())s.startsWith(t+":")&&e.push(s);return e}static clear(){this.sprites.clear(),this.spritesheets.clear()}static removeSprite(t){return this.sprites.delete(t)}static removeSpritesheet(t){return this.spritesheets.delete(t)}constructor(){this.sheets=new Map,console.warn("SpriteRegistry instance methods are deprecated. Use static methods instead.")}add(t){console.warn("SpriteRegistry.add() is deprecated. Use new SpritesheetAsset() instead."),this.sheets.set(t.name,t)}async preload(){console.warn("SpriteRegistry.preload() is deprecated. Use SpriteRegistry.preloadAll() instead.");for(let t of this.sheets.values())await t.load()}getSheet(t){return console.warn("SpriteRegistry.getSheet() is deprecated. Use SpriteRegistry.getSpritesheet() instead."),this.sheets.get(t)}};var f=class{static{l(this,"Component")}constructor(){this.gameObject=null,this.enabled=!0,this._started=!1,this._internalGizmos=this._internalGizmos||(C.instance?._internalGizmos??!1)}__lateStart(){}__update(){}__draw(t){this.enabled&&typeof this.draw=="function"&&this.draw(t),this._internalGizmos&&this.__internalGizmos(t),this.OnDrawGizmos&&typeof this.OnDrawGizmos=="function"&&this.OnDrawGizmos(t)}__preload(){}__internalGizmos(t){}start(){}update(){}draw(t){}async preload(){}destroy(){}lateUpdate(){}};var g=class i{static{l(this,"Vector2")}constructor(t=0,e=0){this.x=t,this.y=e}static get zero(){return new i(0,0)}static get one(){return new i(1,1)}static get up(){return new i(0,1)}static get down(){return new i(0,-1)}static get left(){return new i(-1,0)}static get right(){return new i(1,0)}static get positiveInfinity(){return new i(1/0,1/0)}static get negativeInfinity(){return new i(-1/0,-1/0)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get sqrMagnitude(){return this.x*this.x+this.y*this.y}get normalized(){let t=this.magnitude;return t===0?i.zero:new i(this.x/t,this.y/t)}add(t){return new i(this.x+t.x,this.y+t.y)}subtract(t){return new i(this.x-t.x,this.y-t.y)}multiply(t){return new i(this.x*t,this.y*t)}divide(t){if(t===0)throw new Error("Cannot divide by zero");return new i(this.x/t,this.y/t)}normalize(){let t=this.magnitude;return t===0?(this.x=0,this.y=0):(this.x/=t,this.y/=t),this}set(t,e){return this.x=t,this.y=e,this}clone(){return new i(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}toString(){return`(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}static dot(t,e){return t.x*e.x+t.y*e.y}static distance(t,e){let s=t.x-e.x,o=t.y-e.y;return Math.sqrt(s*s+o*o)}static sqrDistance(t,e){let s=t.x-e.x,o=t.y-e.y;return s*s+o*o}static lerp(t,e,s){return s=Math.max(0,Math.min(1,s)),new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s)}static lerpUnclamped(t,e,s){return new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s)}static min(t,e){return new i(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new i(Math.max(t.x,e.x),Math.max(t.y,e.y))}static moveTowards(t,e,s){let o=e.subtract(t),n=o.magnitude;return n<=s||n===0?e.clone():t.add(o.divide(n).multiply(s))}static reflect(t,e){let s=-2*i.dot(e,t);return new i(s*e.x+t.x,s*e.y+t.y)}static angle(t,e){let s=Math.sqrt(t.sqrMagnitude*e.sqrMagnitude);if(s<1e-15)return 0;let o=Math.max(-1,Math.min(1,i.dot(t,e)/s));return Math.acos(o)}static signedAngle(t,e){let s=i.angle(t,e),o=Math.sign(t.x*e.y-t.y*e.x);return s*o}static clampMagnitude(t,e){let s=t.sqrMagnitude;if(s>e*e){let o=Math.sqrt(s),n=t.x/o,r=t.y/o;return new i(n*e,r*e)}return t.clone()}static rotate(t,e){let s=Math.cos(e),o=Math.sin(e);return new i(t.x*s-t.y*o,t.x*o+t.y*s)}static perpendicular(t){return new i(-t.y,t.x)}static smoothDamp(t,e,s,o,n=1/0,r){o=Math.max(1e-4,o);let a=2/o,h=a*r,c=1/(1+h+.48*h*h+.235*h*h*h),d=t.x-e.x,p=t.y-e.y,u=e.clone(),m=n*o,b=m*m,v=d*d+p*p;if(v>b){let Y=Math.sqrt(v);d=d/Y*m,p=p/Y*m}let E=t.x-d,D=t.y-p,B=(s.x+a*d)*r,L=(s.y+a*p)*r;s.x=(s.x-a*B)*c,s.y=(s.y-a*L)*c;let k=E+(d+B)*c,T=D+(p+L)*c,X=u.x-t.x,F=u.y-t.y,j=k-u.x,O=T-u.y;return X*j+F*O>0&&(k=u.x,T=u.y,s.x=(k-u.x)/r,s.y=(T-u.y)/r),new i(k,T)}};var R=class extends f{static{l(this,"CameraComponent")}constructor(t,e=1){super(),this.canvas=t,this.zoom=e}applyTransform(t){let e=this.gameObject.getGlobalPosition();t.setTransform(this.zoom,0,0,this.zoom,-e.x*this.zoom+this.canvas.width/2,-e.y*this.zoom+this.canvas.height/2)}};var w=class i{static{l(this,"Input")}static keys=new Set;static pressedKeys=new Set;static releasedKeys=new Set;static previousKeys=new Set;static mouseButtons=new Set;static pressedMouseButtons=new Set;static releasedMouseButtons=new Set;static previousMouseButtons=new Set;static mousePosition={x:0,y:0};static lastMousePosition={x:0,y:0};static onKeyDown=new Map;static onKeyStay=new Map;static onKeyUp=new Map;static onMouseDown=new Map;static onMouseStay=new Map;static onMouseUp=new Map;static onMouseMove=new Set;static canvas=null;static initialize(t=null){i.canvas=t,window.addEventListener("keydown",s=>{let o=s.key.toLowerCase();if(!i.keys.has(o)){i.pressedKeys.add(o);let n=i.onKeyDown.get(o);n&&n(o)}i.keys.add(o)}),window.addEventListener("keyup",s=>{let o=s.key.toLowerCase();i.keys.delete(o),i.releasedKeys.add(o);let n=i.onKeyUp.get(o);n&&n(o)});let e=t||window;e.addEventListener("mousedown",s=>{let o=s.button;if(!i.mouseButtons.has(o)){i.pressedMouseButtons.add(o);let n=i.onMouseDown.get(o);n&&n(o,i.mousePosition)}i.mouseButtons.add(o),i.updateMousePosition(s)}),e.addEventListener("mouseup",s=>{let o=s.button;i.mouseButtons.delete(o),i.releasedMouseButtons.add(o);let n=i.onMouseUp.get(o);n&&n(o,i.mousePosition),i.updateMousePosition(s)}),e.addEventListener("mousemove",s=>{i.updateMousePosition(s);for(let o of i.onMouseMove)o(i.mousePosition,i.lastMousePosition)}),t&&t.addEventListener("contextmenu",s=>s.preventDefault())}static updateMousePosition(t){if(i.lastMousePosition={...i.mousePosition},i.canvas){let e=i.canvas.getBoundingClientRect();i.mousePosition.x=t.clientX-e.left,i.mousePosition.y=t.clientY-e.top}else i.mousePosition.x=t.clientX,i.mousePosition.y=t.clientY}static update(){for(let t of i.keys)if(i.previousKeys.has(t)){let e=i.onKeyStay.get(t);e&&e(t)}for(let t of i.mouseButtons)if(i.previousMouseButtons.has(t)){let e=i.onMouseStay.get(t);e&&e(t,i.mousePosition)}i.pressedKeys.clear(),i.releasedKeys.clear(),i.pressedMouseButtons.clear(),i.releasedMouseButtons.clear(),i.previousKeys=new Set(i.keys),i.previousMouseButtons=new Set(i.mouseButtons)}static isKeyDown(t){return i.keys.has(t.toLowerCase())}static isKeyPressed(t){return i.pressedKeys.has(t.toLowerCase())}static isKeyReleased(t){return i.releasedKeys.has(t.toLowerCase())}static isMouseDown(t=0){return i.mouseButtons.has(t)}static isMousePressed(t=0){return i.pressedMouseButtons.has(t)}static isMouseReleased(t=0){return i.releasedMouseButtons.has(t)}static getMousePosition(){return{...i.mousePosition}}static getMouseDelta(){return{x:i.mousePosition.x-i.lastMousePosition.x,y:i.mousePosition.y-i.lastMousePosition.y}}static isLeftMouseDown(){return i.isMouseDown(0)}static isLeftMousePressed(){return i.isMousePressed(0)}static isRightMouseDown(){return i.isMouseDown(2)}static isRightMousePressed(){return i.isMousePressed(2)}static onKeyDownEvent(t,e){i.onKeyDown.set(t.toLowerCase(),e)}static onKeyStayEvent(t,e){i.onKeyStay.set(t.toLowerCase(),e)}static onKeyUpEvent(t,e){i.onKeyUp.set(t.toLowerCase(),e)}static onMouseDownEvent(t=0,e){i.onMouseDown.set(t,e)}static onMouseStayEvent(t=0,e){i.onMouseStay.set(t,e)}static onMouseUpEvent(t=0,e){i.onMouseUp.set(t,e)}static onMouseMoveEvent(t){i.onMouseMove.add(t)}static onLeftClickEvent(t){i.onMouseDownEvent(0,t)}static onRightClickEvent(t){i.onMouseDownEvent(2,t)}static removeKeyEvent(t,e){let s=e.toLowerCase();switch(t){case"down":i.onKeyDown.delete(s);break;case"stay":i.onKeyStay.delete(s);break;case"up":i.onKeyUp.delete(s);break}}static removeMouseEvent(t,e){switch(t){case"down":i.onMouseDown.delete(e);break;case"stay":i.onMouseStay.delete(e);break;case"up":i.onMouseUp.delete(e);break;case"move":i.onMouseMove.delete(e);break}}static clearAllEvents(){i.onKeyDown.clear(),i.onKeyStay.clear(),i.onKeyUp.clear(),i.onMouseDown.clear(),i.onMouseStay.clear(),i.onMouseUp.clear(),i.onMouseMove.clear()}};var M=class extends f{static{l(this,"AbstractColliderComponent")}constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){y.instance.register(this)}destroy(){y.instance.unregister(this)}checkCollisionWith(t){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}};var y=class i{static{l(this,"CollisionSystem")}constructor(){this.colliders=new Set,i.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof M&&e instanceof M?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};y.instance=void 0;var z=class i{static{l(this,"GameObject")}constructor(t=0,e=0){t instanceof g?this.position=t.clone():this.position=new g(t,e),this.rotation=0,this.components=[],this.children=[],this.parent=null,this.name="",this.tags=new Set,this.paused=!1}addComponent(t){if(!(t instanceof f))throw new Error('addComponent: property "component" must be an instance of Component');if(this.getComponent(t.constructor))throw new Error(`Component of type ${t.constructor.name} already exists on this GameObject.`);return t.gameObject=this,this.components.push(t),t}getComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('getComponent: property "type" must be a class');return this.components.find(e=>e instanceof t)}hasComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('hasComponent: property "type" must be a class');return!!this.getComponent(t)}removeComponent(t){let e=this.components.findIndex(s=>s instanceof t);e!==-1&&(this.components[e].destroy?.(),this.components.splice(e,1))}getComponentInChildren(t){if(typeof t!="function"||!t.prototype)throw new Error('hasComponent: property "type" must be a class');return this.children.find(e=>e.hasComponent(t)).getComponent(t)}hasTag(t){return this.tags.has(t)}addTag(t){this.tags.add(t)}__addChild(t){if(!(t instanceof i))throw new Error(`Nity2D: method 'addChild' only accepts GameObject, '${typeof t}' provided`);this.children.push(t),t.parent=this}addChild(t){P.create(t,{parent:this,addToScene:!0})}addChildren(t){if(!Array.isArray(t))throw new Error(`Nity2D: method 'addChildren' only accepts array '${typeof t}' provided`);t.forEach(e=>this.addChild(e))}removeChild(t){let e=this.children.indexOf(t);e!==-1&&(t.parent=null,this.children.splice(e,1))}getGlobalPosition(){return this.parent?this.position.add(this.parent.getGlobalPosition()):this.position.clone()}getGlobalRotation(){return this.parent?this.rotation+this.parent.getGlobalRotation():this.rotation}setPosition(t,e){t instanceof g?this.position.set(t.x,t.y):this.position.set(t,e)}setRotation(t){this.rotation=t}setRotationDegrees(t){this.rotation=t*(Math.PI/180)}getRotationDegrees(){return this.rotation*(180/Math.PI)}getGlobalRotationDegrees(){return this.getGlobalRotation()*(180/Math.PI)}rotate(t){this.rotation+=t}rotateDegrees(t){this.rotation+=t*(Math.PI/180)}translate(t,e){t instanceof g?this.position=this.position.add(t):this.position=this.position.add(new g(t,e))}async preload(){let t=this.components.map(e=>e.preload?.());for(let e of this.children)t.push(e.preload?.());await Promise.all(t)}start(){for(let t of this.components)t.enabled&&typeof t.start=="function"&&t.start();for(let t of this.children)t.start()}update(){if(!this.paused){for(let t of this.components)t.enabled&&typeof t.update=="function"&&t.update();for(let t of this.children)t.update()}}lateUpdate(){if(!this.paused){for(let t of this.components)t.enabled&&typeof t.lateUpdate=="function"&&t.lateUpdate();for(let t of this.children)t.lateUpdate()}}onCollisionEnter(t){for(let e of this.components)typeof e.onCollisionEnter=="function"&&e.onCollisionEnter(t)}onCollisionStay(t){for(let e of this.components)typeof e.onCollisionStay=="function"&&e.onCollisionStay(t)}onCollisionExit(t){for(let e of this.components)typeof e.onCollisionExit=="function"&&e.onCollisionExit(t)}__draw(t){if(!this.paused){for(let e of this.components)e.__draw(t);for(let e of this.children)e.__draw(t)}}};var P=class i{static{l(this,"Instantiate")}static create(t,e={},...s){let{x:o,y:n,parent:r=null,addToScene:a=!0}=e,h;if(typeof t=="function")h=new t(o??0,n??0,...s);else if(t instanceof z)h=t,o!==void 0&&(h.x=o),n!==void 0&&(h.y=n);else throw new Error("Instantiate.create: prefab must be a GameObject instance or constructor function");if(r){if(!(r instanceof z))throw new Error("Instantiate.create: parent must be a GameObject instance");r.__addChild(h)}return a&&!r&&C.instance?.scene&&C.instance.scene.__addObjectToScene(h),i._registerGameObject(h),h}static _registerGameObject(t){for(let e of t.components)i._registerComponent(e);for(let e of t.children)i._registerGameObject(e)}static _registerComponent(t){t instanceof M&&(y.instance?y.instance.register(t):(console.warn("CollisionSystem not initialized. Collider will be registered when system is available:",t),i._pendingColliders||(i._pendingColliders=[]),i._pendingColliders.push(t))),typeof t.start=="function"&&t.start()}static registerPendingColliders(){if(i._pendingColliders&&y.instance){for(let t of i._pendingColliders)y.instance.register(t);i._pendingColliders=[]}}static destroy(t){if(!(t instanceof z))throw new Error("Instantiate.destroy: gameObject must be a GameObject instance");for(let e of[...t.children])i.destroy(e);for(let e of t.components)i._unregisterComponent(e);if(t.parent&&t.parent.removeChild(t),C.instance?.scene){let e=C.instance.scene.objects.indexOf(t);e!==-1&&C.instance.scene.objects.splice(e,1)}}static _unregisterComponent(t){t instanceof M&&y.instance&&y.instance.unregister(t),typeof t.destroy=="function"&&t.destroy()}static clone(t,e={}){if(!(t instanceof z))throw new Error("Instantiate.clone: original must be a GameObject instance");let s=new z(t.x,t.y);s.name=t.name,s.tags=new Set(t.tags);for(let h of t.components){let c=h.constructor,d=new c;for(let p in h)h.hasOwnProperty(p)&&p!=="gameObject"&&(d[p]=h[p]);s.addComponent(d)}for(let h of t.children){let c=i.clone(h,{addToScene:!1});s.__addChild(c)}let{x:o=s.x,y:n=s.y,parent:r=null,addToScene:a=!0}=e;return s.x=o,s.y=n,r&&r.__addChild(s),a&&!r&&C.instance?.scene&&C.instance.scene.__addObjectToScene(s),i._registerGameObject(s),s}};var x=class{static{l(this,"Time")}static#t=performance.now();static#i=performance.now();static#o=0;static#r=1e3;static#s=performance.now();static#n=60;static#e=1;static get deltaTime(){return C.instance?._deltaTime||0}static get unscaleddeltaTime(){return(C.instance?._deltaTime||0)/this.#e}static get time(){return(performance.now()-this.#t)/1e3*this.#e}static get unscaledTime(){return(performance.now()-this.#t)/1e3}static get fps(){return this.#n}static get frameCount(){return this.#o}static get timeScale(){return this.#e}static set timeScale(t){this.#e=Math.max(0,t)}static get timestamp(){return performance.now()}static get realtimeSinceStartup(){return Date.now()}static _updateTimeStats(){let t=performance.now();if(this.#o++,t-this.#s>=this.#r){let e=t-this.#s,s=this.#o-(this.#s===performance.now()?0:Math.floor(e/16.67));this.#n=Math.round(1e3/(e/s))||60,this.#s=t}this.#i=t}static secondsToMilliseconds(t){return t*1e3}static millisecondsToSeconds(t){return t/1e3}static createTimer(t){let e=this.time;return()=>this.time-e>=t}static createInterval(t){let e=this.time;return()=>this.time-e>=t?(e=this.time,!0):!1}static lerp(t,e,s){return t+(e-t)*(1-Math.exp(-s*this.deltaTime))}static _reset(){this.#t=performance.now(),this.#i=performance.now(),this.#o=0,this.#s=performance.now(),this.#n=60,this.#e=1}};var C=class i{static{l(this,"Game")}#t=!1;#i=0;constructor(t){i.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.mainCamera=null,this.paused=!1,this._internalGizmos=!1,this._debugMode=!1,this._deltaTime=0,new y,P.registerPendingColliders()}configure(t={canvas:null,mainCamera:null,debug:!1}){t.canvas&&(this.canvas=t.canvas,this.ctx=this.canvas.getContext("2d")),t.mainCamera&&(this.mainCamera=t.mainCamera),t.debug&&this.#l()}launch(t){if(!t&&!this.scene)throw new Error("No scene assigned to game.");this.#h(),this.#o(t||this.scene)}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await S.preloadAll(),await this.scene.preload(),await this.scene.start(),this.#r()}pause(){this.paused=!0}resume(){this.paused=!1}async#o(t){await this.loadScene(t),this.#r()}#r(){x._reset(),w.initialize(this.canvas),this.#a(),requestAnimationFrame(this.#s.bind(this))}#s(t){if(this._deltaTime=(t-this.#i)/1e3,this._deltaTime>.1&&(this._deltaTime=.1),this.#i=t,x._updateTimeStats(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(!this.paused&&(w.update(),this.scene.__update(),this.mainCamera)){let e=this.mainCamera.getComponent(R);e&&e.applyTransform(this.ctx)}this.scene.__lateUpdate(),this.scene.__draw(this.ctx)}requestAnimationFrame(this.#s.bind(this))}#n(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#e(){this.#t!==!1&&(this.#t=!1,this.#i=performance.now(),console.log("Game fullscale resume"))}#a(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#n():this.#e()})}#h(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}#l(){this._debugMode=!0,this._internalGizmos=!0}};C.instance=null;var W=class{static{l(this,"SpriteAnimationClip")}constructor(t,e=[],s=10,o=!0){this.name=t,this.spriteNames=e,this.fps=s,this.loop=o}};var G=class extends f{static{l(this,"SpriteRendererComponent")}constructor(t,e={}){super(),this.spriteKey=t,this.sprite=null,this.options={width:e.width||null,height:e.height||null,opacity:e.opacity!==void 0?e.opacity:1,flipX:e.flipX||!1,flipY:e.flipY||!1}}preload(){if(this.sprite=S.getSprite(this.spriteKey),!this.sprite)throw new Error(`Sprite '${this.spriteKey}' not found in SpriteRegistry. Make sure the sprite or spritesheet is loaded.`)}__draw(t){if(!this.sprite||!this.sprite.image||!this.sprite.isLoaded)return;let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation(),o=this.options.width||null,n=this.options.height||null,r=this.options.opacity!==1;r&&(t.save(),t.globalAlpha=Math.max(0,Math.min(1,this.options.opacity))),this.sprite.draw(t,e.x,e.y,o,n,s),r&&t.restore()}setSprite(t){this.spriteKey=t,this.sprite=S.getSprite(t),this.sprite||console.warn(`Sprite '${t}' not found in SpriteRegistry.`)}setScale(t,e){this.options.width=t,this.options.height=e}setOptions(t){this.options={...this.options,...t}}getRenderedWidth(){return this.sprite?this.options.width||this.sprite.width:0}getRenderedHeight(){return this.sprite?this.options.height||this.sprite.height:0}getOpacity(){return this.options.opacity}setOpacity(t){this.options.opacity=Math.max(0,Math.min(1,t))}__internalGizmos(t){if(!this.sprite||!this.sprite.image||!this.sprite.isLoaded)return;let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),s!==0&&t.rotate(s),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]);let o=this.getRenderedWidth(),n=this.getRenderedHeight();t.strokeRect(-o/2,-n/2,o,n),t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center",t.fillText(this.spriteKey,0,-n/2-8),t.fillText(`${o}x${n}`,0,n/2+15),t.restore()}};var N=class extends f{static{l(this,"SpriteAnimationComponent")}constructor(t=null){super(),this.clips=new Map,this.currentClip=null,this.currentFrame=0,this.autoPlay=!0,this.time=0,this.defaultClipName=t}start(){this.autoPlay&&this.defaultClipName&&this.play(this.defaultClipName)}addClip(t){this.clips.set(t.name,t)}play(t){let e=this.clips.get(t);if(!e)throw new Error(`Animation clip '${t}' not found.`);this.currentClip=e,this.currentFrame=0,this.time=0,this._applyFrame()}update(){if(!this.currentClip)return;this.time+=x.deltaTime;let t=1/this.currentClip.fps;if(this.time>=t){if(this.time-=t,this.currentFrame++,this.currentFrame>=this.currentClip.spriteNames.length)if(this.currentClip.loop)this.currentFrame=0;else{this.currentFrame=this.currentClip.spriteNames.length-1;return}this._applyFrame()}}_applyFrame(){if(!this.currentClip||!this.currentClip.spriteNames[this.currentFrame])return;let t=this.currentClip.spriteNames[this.currentFrame],e=this.gameObject.getComponent(G);e&&e.setSprite(t)}};var H=class{static{l(this,"Scene")}constructor({create:t}={}){this.objects=[],this._create=t}add(t){P.create(t)}__addObjectToScene(t){if(!(t instanceof z))throw new Error(`[Nity] Forbidden object '${t?t.constructor.name:null}' added to the scene. Accepts only 'GameObject'.`);this.objects.push(t)}findByName(t){return this.objects.find(e=>e.name===t)}findByTag(t){return this.objects.filter(e=>e.hasTag(t))}async preload(){typeof this._create=="function"&&(this._create(this),this._create=null);let t=this.objects.map(e=>e?.preload?.());await Promise.all(t)}async start(){for(let t of this.objects)typeof t?.start=="function"&&t?.start();setTimeout(()=>{},500)}update(){}lateUpdate(){}__update(){for(let t of this.objects)typeof t?.update=="function"&&t?.update();y.instance?y.instance?.update():console.warn("Scene: CollisionSystem.instance is null!"),this?.update()}__lateUpdate(){for(let t of this.objects)typeof t.lateUpdate=="function"&&t?.lateUpdate();this?.lateUpdate()}__draw(t){for(let e of this.objects)e.__draw(t)}};var q=class extends f{static{l(this,"GravityComponent")}constructor(t={gravityScale:300}){super(),this.gravity=!0,this.gravityScale=t.gravityScale||300,this.velocity=new g(0,0)}update(){this.gravity&&(this.velocity.y+=this.gravityScale*x.deltaTime)}_doMove(t,e){t instanceof g?this.gameObject.translate(t):this.gameObject.translate(t,e)}};var I=class i extends q{static{l(this,"RigidbodyComponent")}#t;#i=new Set;bounciness=0;gravity=!1;gravityScale=300;constructor(t={gravity:!1,gravityScale:300,bounciness:0}){super(t),this.gravity=t.gravity!=null?t.gravity:!1,this.bounciness=t.bounciness||0}start(){this.#t=this.gameObject.getComponent(M),this.#t||console.warn("RigidbodyComponent requires a collider.")}update(){super.update();let t=this.velocity.multiply(x.deltaTime);this.move(t.x,t.y)}move(t,e){let s,o;t instanceof g?(s=t.x,o=t.y):(s=t,o=e);let n=Math.max(Math.abs(s),Math.abs(o)),r=Math.max(1,Math.ceil(n/.25)),a=s/r,h=o/r,c=new Set,d=!1,p=new g(0,0);for(let u=0;u<r;u++){let m=this.gameObject.position.clone();if(this._doMove(a,h),p=p.add(new g(a,h)),this.#t)for(let b of y.instance.colliders){if(b===this.#t||!this.#t.checkCollisionWith(b))continue;let v=b.gameObject;c.add(v);let E=this.#i.has(v),D=this.#t.isTrigger()||b.isTrigger();if(E?(this.#n(this.gameObject,v),v.hasComponent?.(i)||this.#n(v,this.gameObject)):(this.#s(this.gameObject,v),v.hasComponent?.(i)||this.#s(v,this.gameObject)),!D&&!d){this.gameObject.setPosition(m),Math.abs(h)>Math.abs(a)?this.velocity.y*=-this.bounciness:this.velocity.x*=-this.bounciness,d=!0;break}}if(d)break;this.#o(c),this.#i=c}return!0}#o(t){for(let e of this.#i)if(!t.has(e)){let s=e.getComponent(M);s?this.#r(s,2.5)?t.add(e):(this.#e(this.gameObject,e),e?.hasComponent?.(i)||this.#e(e,this.gameObject)):(this.#e(this.gameObject,e),e?.hasComponent?.(i)||this.#e(e,this.gameObject))}}#r(t,e=2){let s=this.#t.getBounds(),o=t.getBounds();return s.x<o.x+o.width+e&&s.x+s.width+e>o.x&&s.y<o.y+o.height+e&&s.y+s.height+e>o.y}#s(t,e){t?.getComponent?.(M)?.isTrigger()?t?.onTriggerEnter?.(e):t?.onCollisionEnter?.(e)}#n(t,e){t?.getComponent?.(M)?.isTrigger()?t?.onTriggerStay?.(e):t?.onCollisionStay?.(e)}#e(t,e){t?.getComponent?.(M)?.isTrigger()?t?.onTriggerExit?.(e):t?.onCollisionExit?.(e)}_doMove(t,e){t instanceof g?this.gameObject.translate(t):this.gameObject.translate(t,e)}};var U=class extends f{static{l(this,"MovementComponent")}rigidbody;constructor(t=100){super(),this.speed=t}start(){this.rigidbody=this.gameObject.getComponent(I),this.rigidbody||console.warn("MovementComponent requires RigidbodyComponent to function properly.")}update(){let t=new g(0,0);(w.isKeyDown("ArrowRight")||w.isKeyDown("d")||w.isKeyDown("D"))&&(t.x+=this.speed*x.deltaTime),(w.isKeyDown("ArrowLeft")||w.isKeyDown("a")||w.isKeyDown("A"))&&(t.x-=this.speed*x.deltaTime),(w.isKeyDown("ArrowDown")||w.isKeyDown("s")||w.isKeyDown("S"))&&(t.y+=this.speed*x.deltaTime),(w.isKeyDown("ArrowUp")||w.isKeyDown("w")||w.isKeyDown("W"))&&(t.y-=this.speed*x.deltaTime),t.magnitude>0&&this.rigidbody.move(t)}},Z=class extends U{static{l(this,"MovementController")}};var J=class{static{l(this,"Sprite")}constructor(t,e,s,o,n){this.image=t,this.x=e,this.y=s,this.width=o,this.height=n,this.isLoaded=!0}draw(t,e,s,o,n,r=0){if(!this.image)return;let a=o||this.width,h=n||this.height;t.save(),r!==0?(t.translate(e+a/2,s+h/2),t.rotate(r),t.drawImage(this.image,this.x,this.y,this.width,this.height,-a/2,-h/2,a,h)):t.drawImage(this.image,this.x,this.y,this.width,this.height,e,s,a,h),t.restore()}};var Q=class i{static{l(this,"SpriteAsset")}constructor(t,e,s={}){if(t.includes(":"))throw new Error(`SpriteAsset name "${t}" cannot contain colons. Colons are reserved for spritesheet sprite notation (e.g., "sheet:sprite").`);this.name=t,this.imagePath=e,this.image=null,this.isLoaded=!1,this.width=s.width||null,this.height=s.height||null,this.pivotX=s.pivotX||.5,this.pivotY=s.pivotY||.5,this.#t(),this.load()}#t(){S._addSprite(this.name,this)}load(){return new Promise((t,e)=>{this.image=new Image,this.image.onload=()=>{this.isLoaded=!0,this.width||(this.width=this.image.width),this.height||(this.height=this.image.height),t(this)},this.image.onerror=e,this.image.src=this.imagePath})}draw(t,e,s,o,n,r=0,a=1,h=1){if(!this.isLoaded)return;let c=o||this.width,d=n||this.height;t.save(),t.translate(e,s),r!==0&&t.rotate(r),t.scale(a,h);let p=-c*this.pivotX,u=-d*this.pivotY;t.drawImage(this.image,p,u,c,d),t.restore()}getBounds(t,e,s,o){let n=s||this.width,r=o||this.height;return{x:t-n*this.pivotX,y:e-r*this.pivotY,width:n,height:r}}clone(t={}){let e={width:this.width,height:this.height,pivotX:this.pivotX,pivotY:this.pivotY,...t};return new i(this.imagePath,e)}};var V=class{static{l(this,"SpritesheetAsset")}constructor(t,e,s){if(t.includes(":"))throw new Error(`SpritesheetAsset name "${t}" cannot contain colons. Colons are reserved for sprite notation within sheets.`);this.name=t,this.imagePath=e,this.spriteData=s,this.image=null,this.isLoaded=!1,this.sprites=new Map,this.generateSprites(),this._registerSelf(),this.load()}_registerSelf(){S._addSpritesheet(this.name,this),this._registerIndividualSprites()}load(){return new Promise((t,e)=>{this.image=new Image,this.image.onload=()=>{this.isLoaded=!0,this._updateSpriteWrappers(),t(this)},this.image.onerror=e,this.image.src=this.imagePath})}generateSprites(){let{spriteWidth:t,spriteHeight:e,columns:s,rows:o,sprites:n,namedSprites:r}=this.spriteData;if(s!=null&&o!=null&&t!=null&&e!=null)for(let a=0;a<o;a++)for(let h=0;h<s;h++){let d=`sprite_${a*s+h}`,p={x:h*t,y:a*e,width:t,height:e};this.sprites.set(d,p)}n!=null&&Array.isArray(n)&&n.forEach(a=>{if(a.name&&a.startX!=null&&a.startY!=null&&a.endX!=null&&a.endY!=null){let h={x:a.startX,y:a.startY,width:a.endX-a.startX,height:a.endY-a.startY};this.sprites.set(a.name,h)}else console.warn(`Invalid sprite definition in "${this.name}":`,a)}),r!=null&&typeof r=="object"&&!Array.isArray(r)&&Object.entries(r).forEach(([a,h])=>{this.sprites.set(a,h)})}_updateSpriteWrappers(){for(let t of this.sprites.keys()){let e=`${this.name}:${t}`,s=S.getSprite(e);s&&(s.image=this.image,s.isLoaded=this.isLoaded)}}_registerIndividualSprites(){for(let t of this.sprites.keys()){let e=`${this.name}:${t}`;S._addSprite(e,this._createSpriteWrapper(t))}}_createSpriteWrapper(t){let e=this.sprites.get(t);return e?{name:`${this.name}:${t}`,image:this.image,isLoaded:this.isLoaded,width:e.width,height:e.height,pivotX:.5,pivotY:.5,sourceX:e.x,sourceY:e.y,sourceWidth:e.width,sourceHeight:e.height,draw:l((s,o,n,r,a,h=0,c=1,d=1)=>{if(!this.isLoaded||!this.image)return;let p=r||e.width,u=a||e.height;s.save(),s.translate(o,n),h!==0&&s.rotate(h),s.scale(c,d);let m=-p*.5,b=-u*.5;s.drawImage(this.image,e.x,e.y,e.width,e.height,m,b,p,u),s.restore()},"draw"),getBounds:l((s,o,n,r)=>{let a=n||e.width,h=r||e.height;return{x:s-a*.5,y:o-h*.5,width:a,height:h}},"getBounds")}:null}getSprite(t){return this.sprites.get(t)||null}getSpriteNames(){return Array.from(this.sprites.keys())}drawSprite(t,e,s,o,n,r){if(!this.isLoaded)return;let a=this.getSprite(e);if(!a)return;let h=n||a.width,c=r||a.height;t.drawImage(this.image,a.x,a.y,a.width,a.height,s,o,h,c)}};var _=class extends f{static{l(this,"ImageComponent")}constructor(t,e=null,s=null){super(),this.src=t,this.image=null,this.width=e,this.height=s}async preload(){return new Promise(t=>{let e=new Image;e.src=this.src,e.onload=()=>{this.image=e,this.width===null&&(this.width=e.width),this.height===null&&(this.height=e.height),t()}})}draw(t){if(this.image){let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),s!==0&&t.rotate(s),t.drawImage(this.image,-this.width/2,-this.height/2,this.width,this.height),t.restore()}}__internalGizmos(t){if(!this.image)return;let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),s!==0&&t.rotate(s),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center";let o=this.src.split("/").pop();t.fillText(o,0,-this.height/2-8),t.fillText(`${this.width}x${this.height}`,0,this.height/2+15),t.restore()}};var tt=class extends f{static{l(this,"ShapeComponent")}constructor(t,e={width:10,height:10,color:"white"}){super(),this.shape=t,this.options=e}get color(){return this.options.color||"black"}set color(t){this.options.color=t}get width(){return this.options.width||10}set width(t){this.options.width=t}get height(){return this.options.height||10}set height(t){this.options.height=t}get radius(){return this.options.radius||10}set radius(t){this.options.radius=t}get radiusX(){return this.options.radiusX||10}set radiusX(t){this.options.radiusX=t}get radiusY(){return this.options.radiusY||5}set radiusY(t){this.options.radiusY=t}get points(){return this.options.points||[]}set points(t){this.options.points=t}get x2(){return this.options.x2||10}set x2(t){this.options.x2=t}get y2(){return this.options.y2||0}set y2(t){this.options.y2=t}get size(){return this.options.size||20}set size(t){this.options.size=t}__draw(t){let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation();t.save(),s!==0?(t.translate(e.x,e.y),t.rotate(s),this.drawShape(t,0,0)):this.drawShape(t,e.x,e.y),t.restore()}drawShape(t,e,s){switch(this.shape){case"rectangle":case"square":this.drawRect(t,e,s);break;case"circle":this.drawCircle(t,e,s);break;case"ellipse":this.drawEllipse(t,e,s);break;case"line":this.drawLine(t,e,s);break;case"triangle":this.drawTriangle(t,e,s);break;case"polygon":this.drawPolygon(t,e,s);break;default:this.drawRect(t,e,s);break}}drawRect(t,e,s){let{width:o=10,height:n=10,color:r="black"}=this.options;t.fillStyle=r,t.fillRect(e-o/2,s-n/2,o,n)}drawCircle(t,e,s){let{radius:o=10,color:n="black"}=this.options;t.beginPath(),t.arc(e,s,o,0,Math.PI*2),t.fillStyle=n,t.fill()}drawEllipse(t,e,s){let{radiusX:o=10,radiusY:n=5,color:r="black"}=this.options;t.beginPath(),t.ellipse(e,s,o,n,0,0,Math.PI*2),t.fillStyle=r,t.fill()}drawLine(t,e,s){let{x2:o=e+10,y2:n=s,color:r="black",width:a=2}=this.options;t.strokeStyle=r,t.lineWidth=a,t.beginPath(),t.moveTo(e,s),t.lineTo(o,n),t.stroke()}drawTriangle(t,e,s){let{size:o=20,color:n="black"}=this.options;t.fillStyle=n,t.beginPath(),t.moveTo(e,s),t.lineTo(e+o,s),t.lineTo(e+o/2,s-o),t.closePath(),t.fill()}drawPolygon(t,e,s){let{points:o=[],color:n="black"}=this.options;if(!(o.length<3)){t.fillStyle=n,t.beginPath(),t.moveTo(e+o[0][0],s+o[0][1]);for(let r=1;r<o.length;r++)t.lineTo(e+o[r][0],s+o[r][1]);t.closePath(),t.fill()}}__internalGizmos(t){if(!this.gameObject)return;let e=this.gameObject.getGlobalPosition(),s=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),s!==0&&t.rotate(s),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]);let{shape:o,size:n=10,width:r=10,height:a=10}=this.options;switch(o){case"rectangle":t.strokeRect(-r/2,-a/2,r,a);break;case"circle":t.beginPath(),t.arc(0,0,n,0,2*Math.PI),t.stroke();break;case"triangle":let c=n;t.beginPath(),t.moveTo(0,-c/2),t.lineTo(-n/2,c/2),t.lineTo(n/2,c/2),t.closePath(),t.stroke();break;case"polygon":let{points:d=[]}=this.options;if(d.length>=3){t.beginPath(),t.moveTo(d[0][0],d[0][1]);for(let p=1;p<d.length;p++)t.lineTo(d[p][0],d[p][1]);t.closePath(),t.stroke()}break}t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center",t.fillText(`Shape: ${o||"none"}`,0,-Math.max(n,a)/2-8);let h="";switch(o){case"rectangle":h=`${r}x${a}`;break;case"circle":h=`r:${n}`;break;case"triangle":h=`s:${n}`;break;case"polygon":h=`${this.options.points?.length||0} pts`;break}h&&t.fillText(h,0,Math.max(n,a)/2+15),t.restore()}};var K=class i extends M{static{l(this,"CircleColliderComponent")}constructor(t=null,e=!1){super(),this.radius=t,this.trigger=e}checkCollisionWith(t){if(t instanceof i){let e=this.getBounds(),s=t.getBounds(),o=e.x-s.x,n=e.y-s.y;return Math.hypot(o,n)<e.radius+s.radius}else return this.circleBoxCollision(t)}circleBoxCollision(t){let e=this.getBounds(),s=t.getBounds(),o=Math.max(s.x,Math.min(e.x,s.x+s.width)),n=Math.max(s.y,Math.min(e.y,s.y+s.height)),r=e.x-o,a=e.y-n;return r*r+a*a<e.radius*e.radius}getBounds(){let t=this.gameObject.getGlobalPosition(),e=this.radius;return{x:t.x,y:t.y,radius:e}}__internalGizmos(t){let e=this.getBounds();t.save(),t.strokeStyle=this.trigger?"#00ffddff":"#00FF00",t.lineWidth=1,t.setLineDash([2,2]),t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2),t.stroke();let s=3;t.setLineDash([]),t.beginPath(),t.moveTo(e.x-s,e.y),t.lineTo(e.x+s,e.y),t.moveTo(e.x,e.y-s),t.lineTo(e.x,e.y+s),t.stroke(),t.restore()}};var et=class i extends M{static{l(this,"BoxColliderComponent")}constructor(t=null,e=null,s=!1){super(),this.width=t,this.height=e,this.trigger=s}checkCollisionWith(t){return t instanceof i?this.checkBoxBoxCollision(t):t instanceof K?t.checkCollisionWith(this):!1}checkBoxBoxCollision(t){let e=this.getBounds(),s=t.getBounds(),o=.01;return e.x<s.x+s.width+o&&e.x+e.width+o>s.x&&e.y<s.y+s.height+o&&e.y+e.height+o>s.y}getBounds(){let t=this.gameObject.getGlobalPosition(),e=this.width,s=this.height;return{x:t.x-e/2,y:t.y-s/2,width:e,height:s}}__internalGizmos(t){let e=this.getBounds();t.save(),t.strokeStyle=this.trigger?"#00ffddff":"#00FF00",t.lineWidth=1,t.setLineDash([2,2]),t.strokeRect(e.x,e.y,e.width,e.height);let s=e.x+e.width/2,o=e.y+e.height/2,n=3;t.setLineDash([]),t.beginPath(),t.moveTo(s-n,o),t.lineTo(s+n,o),t.moveTo(s,o-n),t.lineTo(s,o+n),t.stroke(),t.restore()}};var st=class{static{l(this,"Random")}static range(t,e){return Math.floor(Math.random()*(e-t+1)+t)}};var it=class i{static{l(this,"Vector3")}constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}static get zero(){return new i(0,0,0)}static get one(){return new i(1,1,1)}static get up(){return new i(0,1,0)}static get down(){return new i(0,-1,0)}static get left(){return new i(-1,0,0)}static get right(){return new i(1,0,0)}static get forward(){return new i(0,0,1)}static get back(){return new i(0,0,-1)}static get positiveInfinity(){return new i(1/0,1/0,1/0)}static get negativeInfinity(){return new i(-1/0,-1/0,-1/0)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}get sqrMagnitude(){return this.x*this.x+this.y*this.y+this.z*this.z}get normalized(){let t=this.magnitude;return t===0?i.zero:new i(this.x/t,this.y/t,this.z/t)}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)}subtract(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)}multiply(t){return new i(this.x*t,this.y*t,this.z*t)}divide(t){if(t===0)throw new Error("Cannot divide by zero");return new i(this.x/t,this.y/t,this.z/t)}normalize(){let t=this.magnitude;return t===0?(this.x=0,this.y=0,this.z=0):(this.x/=t,this.y/=t,this.z/=t),this}set(t,e,s){return this.x=t,this.y=e,this.z=s,this}clone(){return new i(this.x,this.y,this.z)}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}toString(){return`(${this.x.toFixed(2)}, ${this.y.toFixed(2)}, ${this.z.toFixed(2)})`}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){return new i(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static distance(t,e){let s=t.x-e.x,o=t.y-e.y,n=t.z-e.z;return Math.sqrt(s*s+o*o+n*n)}static sqrDistance(t,e){let s=t.x-e.x,o=t.y-e.y,n=t.z-e.z;return s*s+o*o+n*n}static lerp(t,e,s){return s=Math.max(0,Math.min(1,s)),new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s,t.z+(e.z-t.z)*s)}static lerpUnclamped(t,e,s){return new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s,t.z+(e.z-t.z)*s)}static slerp(t,e,s){s=Math.max(0,Math.min(1,s));let o=i.dot(t.normalized,e.normalized),n=Math.max(-1,Math.min(1,o));if(Math.abs(n)>.9995)return i.lerp(t,e,s);let r=Math.acos(Math.abs(n)),a=Math.sin(r),h=Math.sin((1-s)*r)/a,c=Math.sin(s*r)/a;return n<0?new i(h*t.x-c*e.x,h*t.y-c*e.y,h*t.z-c*e.z):new i(h*t.x+c*e.x,h*t.y+c*e.y,h*t.z+c*e.z)}static min(t,e){return new i(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))}static max(t,e){return new i(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))}static moveTowards(t,e,s){let o=e.subtract(t),n=o.magnitude;return n<=s||n===0?e.clone():t.add(o.divide(n).multiply(s))}static reflect(t,e){let s=-2*i.dot(e,t);return new i(s*e.x+t.x,s*e.y+t.y,s*e.z+t.z)}static angle(t,e){let s=Math.sqrt(t.sqrMagnitude*e.sqrMagnitude);if(s<1e-15)return 0;let o=Math.max(-1,Math.min(1,i.dot(t,e)/s));return Math.acos(o)}static project(t,e){let s=e.sqrMagnitude;if(s<1e-15)return i.zero;let o=i.dot(t,e);return e.multiply(o/s)}static projectOnPlane(t,e){let s=e.sqrMagnitude;if(s<1e-15)return t.clone();let o=i.dot(t,e);return t.subtract(e.multiply(o/s))}static clampMagnitude(t,e){let s=t.sqrMagnitude;if(s>e*e){let o=Math.sqrt(s),n=t.x/o,r=t.y/o,a=t.z/o;return new i(n*e,r*e,a*e)}return t.clone()}static rotateTowards(t,e,s,o){let n=t.magnitude,r=e.magnitude;if(n>1e-15&&r>1e-15){let h=t.divide(n),c=e.divide(r),d=i.angle(h,c);if(d>1e-15){let p=Math.min(1,s/d),u=i.slerp(h,c,p),m=n+Math.max(-o,Math.min(o,r-n));return u.multiply(m)}}let a=n+Math.max(-o,Math.min(o,r-n));return e.normalized.multiply(a)}static smoothDamp(t,e,s,o,n=1/0,r){o=Math.max(1e-4,o);let a=2/o,h=a*r,c=1/(1+h+.48*h*h+.235*h*h*h),d=t.x-e.x,p=t.y-e.y,u=t.z-e.z,m=e.clone(),b=n*o,v=b*b,E=d*d+p*p+u*u;if(E>v){let $=Math.sqrt(E);d=d/$*b,p=p/$*b,u=u/$*b}let D=t.x-d,B=t.y-p,L=t.z-u,k=(s.x+a*d)*r,T=(s.y+a*p)*r,X=(s.z+a*u)*r;s.x=(s.x-a*k)*c,s.y=(s.y-a*T)*c,s.z=(s.z-a*X)*c;let F=D+(d+k)*c,j=B+(p+T)*c,O=L+(u+X)*c,Y=m.x-t.x,nt=m.y-t.y,rt=m.z-t.z,at=F-m.x,ht=j-m.y,lt=O-m.z;return Y*at+nt*ht+rt*lt>0&&(F=m.x,j=m.y,O=m.z,s.x=(F-m.x)/r,s.y=(j-m.y)/r,s.z=(O-m.z)/r),new i(F,j,O)}static orthonormalize(t){let e=t.normalized,s;Math.abs(e.x)<.9?s=i.cross(e,i.right).normalized:s=i.cross(e,i.up).normalized;let o=i.cross(e,s).normalized;return{normal:e,tangent:s,binormal:o}}};var ot=class extends f{static{l(this,"FollowTarget")}constructor(t){super(),this.target=t}update(){this.target&&(this.target instanceof g?this.gameObject.setPosition(this.target):this.target.position?this.gameObject.setPosition(this.target.position):this.gameObject.setPosition(this.target.x,this.target.y))}};return ft(gt);})();

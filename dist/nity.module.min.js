var a=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(t){}draw(t){}async preload(){}destroy(){}lateUpdate(t){}};var F=class{constructor(t,e=[],i=10,o=!0){this.name=t,this.spriteNames=e,this.fps=i,this.loop=o}};var w=class{constructor(){this.sheets=new Map}add(t){this.sheets.set(t.name,t)}async preload(){for(let t of this.sheets.values())await t.load()}getSheet(t){return this.sheets.get(t)}};var y=class extends a{constructor(t,e=1){super(),this.canvas=t,this.zoom=e}applyTransform(t){let e=this.gameObject.getGlobalX(),i=this.gameObject.getGlobalY();t.setTransform(this.zoom,0,0,this.zoom,-e*this.zoom+this.canvas.width/2,-i*this.zoom+this.canvas.height/2)}};var m=class s{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>s.keys.add(t.key)),window.addEventListener("keyup",t=>s.keys.delete(t.key))}static isKeyDown(t){return s.keys.has(t)}};var h=class extends a{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){l.instance.register(this)}destroy(){l.instance.unregister(this)}checkCollisionWith(t){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}};var l=class s{constructor(){this.colliders=new Set,s.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof h&&e instanceof h?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};l.instance=void 0;var d=class s{#t=!1;constructor(t){s.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new w,this.#t=!1,new l}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){m.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(y);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};d.instance=null;var g=class extends a{constructor(t,e){super(),this.sheetName=t,this.spriteName=e,this.sprite=null}preload(){let t=d.instance.spriteRegistry.getSheet(this.sheetName);if(!t)throw new Error(`Spritesheet '${this.sheetName}' not found.`);if(this.sprite=t.getSprite(this.spriteName),!this.sprite)throw new Error(`Sprite '${this.spriteName}' not found in sheet '${this.sheetName}'.`)}draw(t){if(!this.sprite)return;let e=this.gameObject.getGlobalX(),i=this.gameObject.getGlobalY();t.drawImage(this.sprite.image,this.sprite.x,this.sprite.y,this.sprite.width,this.sprite.height,e,i,this.sprite.width,this.sprite.height)}};var A=class extends a{constructor(t,e=null){super(),this.sheetName=t,this.clips=new Map,this.currentClip=null,this.currentFrame=0,this.autoPlay=!0,this.time=0,this.defaultClipName=e}start(){this.autoPlay&&this.defaultClipName&&this.play(this.defaultClipName)}addClip(t){this.clips.set(t.name,t)}play(t){let e=this.clips.get(t);if(!e)throw new Error(`Animation clip '${t}' not found.`);this.currentClip=e,this.currentFrame=0,this.time=0,this._applyFrame()}update(t){if(!this.currentClip)return;this.time+=t;let e=1/this.currentClip.fps;if(this.time>=e){if(this.time-=e,this.currentFrame++,this.currentFrame>=this.currentClip.spriteNames.length)if(this.currentClip.loop)this.currentFrame=0;else{this.currentFrame=this.currentClip.spriteNames.length-1;return}this._applyFrame()}}_applyFrame(){let t=this.currentClip.spriteNames[this.currentFrame],e=this.gameObject.getComponent(g);e&&(e.sprite=d.instance.spriteRegistry.getSheet(this.sheetName).getSprite(t))}};var I=class{constructor(t=0,e=0){this.x=t,this.y=e,this.components=[],this.children=[],this.parent=null,this.name="",this.tags=new Set,this.paused=!1}addComponent(t){if(!(t instanceof a))throw new Error('addComponent: property "component" must be an instance of Component');if(this.getComponent(t.constructor))throw new Error(`Component of type ${t.constructor.name} already exists on this GameObject.`);return t.gameObject=this,this.components.push(t),t.start?.(),t}getComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('getComponent: property "type" must be a class');return this.components.find(e=>e instanceof t)}hasComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('hasComponent: property "type" must be a class');return!!this.getComponent(t)}removeComponent(t){let e=this.components.findIndex(i=>i instanceof t);e!==-1&&(this.components[e].destroy?.(),this.components.splice(e,1))}hasTag(t){return this.tags.has(t)}addTag(t){this.tags.add(t)}addChild(t){this.children.push(t),t.parent=this}removeChild(t){let e=this.children.indexOf(t);e!==-1&&(t.parent=null,this.children.splice(e,1))}getGlobalX(){return this.parent?this.x+this.parent.getGlobalX():this.x}getGlobalY(){return this.parent?this.y+this.parent.getGlobalY():this.y}async preload(){let t=this.components.map(e=>e.preload?.());for(let e of this.children)t.push(e.preload?.());await Promise.all(t)}update(t){if(!this.paused){for(let e of this.components)e.enabled&&typeof e.update=="function"&&e.update(t);for(let e of this.children)e.update(t)}}lateUpdate(t){if(!this.paused){for(let e of this.components)e.enabled&&typeof e.lateUpdate=="function"&&e.lateUpdate(t);for(let e of this.children)e.lateUpdate(t)}}onCollisionEnter(t){for(let e of this.components)typeof e.onCollisionEnter=="function"&&e.onCollisionEnter(t)}onCollisionStay(t){for(let e of this.components)typeof e.onCollisionStay=="function"&&e.onCollisionStay(t)}onCollisionExit(t){for(let e of this.components)typeof e.onCollisionExit=="function"&&e.onCollisionExit(t)}draw(t){if(!this.paused){for(let e of this.components)e.enabled&&typeof e.draw=="function"&&e.draw(t);for(let e of this.children)e.draw(t)}}};var W=class{constructor({create:t}={}){this.objects=[],this._create=t}add(t){this.objects.push(t)}findByName(t){return this.objects.find(e=>e.name===t)}findByTag(t){return this.objects.filter(e=>e.hasTag(t))}async preload(){typeof this._create=="function"?(this._create(this),this._create=null):console.log("Empty scene loaded");let t=this.objects.map(e=>e.preload?.());await Promise.all(t)}async start(){for(let t of this.objects)typeof t.start=="function"&&t.start()}update(t){for(let e of this.objects)typeof e.update=="function"&&e.update(t);l.instance?.update();for(let e of this.objects)typeof e.lateUpdate=="function"&&e.lateUpdate(t)}draw(t){for(let e of this.objects)e.draw(t)}};var b=class extends a{constructor(t={gravityScale:300}){super(),this.gravity=!0,this.gravityScale=t.gravityScale||300,this.velocity={x:0,y:0}}update(t){this.gravity&&(this.velocity.y+=this.gravityScale*t)}_doMove(t,e){this.gameObject.x+=t,this.gameObject.y+=e}};var C=class s extends b{#t;#e=new Set;bounciness=0;gravity=!1;gravityScale=300;constructor(t={gravity:!1,gravityScale:300,bounciness:0}){super(t),this.gravity=t.gravity!=null?t.gravity:!1,this.bounciness=t.bounciness||0}start(){this.#t=this.gameObject.getComponent(h),this.#t||console.warn("RigidbodyComponent requires a collider.")}update(t){super.update(t),this.move(this.velocity.x*t,this.velocity.y*t)}move(t,e){if(!this.#t)return!0;let i=Math.ceil(Math.max(Math.abs(t),Math.abs(e))/1),o=t/i,n=e/i,r=new Set,c=!1;for(let u=0;u<i;u++){this._doMove(o,n);for(let f of l.instance.colliders){if(f===this.#t||!this.#t.checkCollisionWith(f))continue;let p=f.gameObject;r.add(p);let ut=this.#e.has(p),ft=this.#t.isTrigger()||f.isTrigger();if(ut?(this.#a(this.gameObject,p),p.hasComponent?.(s)||this.#a(p,this.gameObject)):(this.#r(this.gameObject,p),p.hasComponent?.(s)||this.#r(p,this.gameObject)),!ft&&!c){Math.abs(n)>Math.abs(o)?this.velocity.y*=-this.bounciness:this.velocity.x*=-this.bounciness,this._doMove(-o,-n),c=!0;break}}if(c)break}for(let u of this.#e)r.has(u)||(this.#h(this.gameObject,u),u?.hasComponent?.(s)||this.#h(u,this.gameObject));return this.#e=r,!0}#s(t,e){this.gameObject.x+=t,this.gameObject.y+=e}#i(t,e){this.gameObject.x-=t,this.gameObject.y-=e}#o(t){return!this.#t.isTrigger()&&!t.isTrigger()}#n(t,e){let i=this.#e.has(e),o=this.#t.isTrigger()||t.isTrigger();i?(this.#a(this.gameObject,e),e?.hasComponent?.(s)||this.#a(e,this.gameObject)):(this.#r(this.gameObject,e),e?.hasComponent?.(s)||this.#r(e,this.gameObject))}#l(t){for(let e of this.#e)if(!t.has(e)){let i=e.getComponent?.(h),o=this.#t.isTrigger()||i?.isTrigger();this.#h(this.gameObject,e),i?.hasComponent?.(s)||this.#h(e,this.gameObject)}}#r(t,e){t?.getComponent?.(h)?.isTrigger()?t?.onTriggerEnter?.(e):t?.onCollisionEnter?.(e)}#a(t,e){t?.getComponent?.(h)?.isTrigger()?t?.onTriggerStay?.(e):t?.onCollisionStay?.(e)}#h(t,e){t?.getComponent?.(h)?.isTrigger()?t?.onTriggerExit?.(e):t?.onCollisionExit?.(e)}};var P=class extends a{rigidbody;constructor(t=100){super(),this.speed=t}start(){this.rigidbody=this.gameObject.getComponent(C),this.rigidbody||console.warn("MovementComponent requires RigidbodyComponent to function properly.")}update(t){let e=0,i=0;m.isKeyDown("ArrowRight")&&(e+=this.speed*t),m.isKeyDown("ArrowLeft")&&(e-=this.speed*t),m.isKeyDown("ArrowDown")&&(i+=this.speed*t),m.isKeyDown("ArrowUp")&&(i-=this.speed*t),(e!==0||i!==0)&&this.rigidbody.move(e,i)}};var x=class{constructor(t,e,i,o,n){this.image=t,this.x=e,this.y=i,this.width=o,this.height=n}};var L=class{constructor(t,e,i,o,n,r){this.name=t,this.src=e,this.image=null,this.frameWidth=i,this.frameHeight=o,this.cols=n,this.rows=r,this.sprites=new Map,d.instance.spriteRegistry.add(this)}async load(){return new Promise((t,e)=>{let i=new Image;i.src=this.src,i.onload=()=>{this.image=i;for(let o=0;o<this.rows;o++)for(let n=0;n<this.cols;n++){let r=`sprite_${n}_${o}`,c=new x(i,n*this.frameWidth,o*this.frameHeight,this.frameWidth,this.frameHeight);this.sprites.set(r,c)}t()},i.onerror=()=>{e(new Error(`Failed to load image: ${this.src}`))}})}getSprite(t){return this.sprites.get(t)}};var X=class extends a{constructor(t){super(),this.src=t,this.image=null}async preload(){return new Promise(t=>{let e=new Image;e.src=this.src,e.onload=()=>{this.image=e,t()}})}draw(t){if(this.image){let e=this.gameObject.getGlobalX(),i=this.gameObject.getGlobalY();t.drawImage(this.image,e,i)}}};var Y=class extends a{constructor(t,e={width:10,height:10,color:"white"}){super(),this.shape=t,this.options=e}get color(){return this.options.color||"black"}set color(t){this.options.color=t}get width(){return this.options.width||10}set width(t){this.options.width=t}get height(){return this.options.height||10}set height(t){this.options.height=t}get radius(){return this.options.radius||10}set radius(t){this.options.radius=t}get radiusX(){return this.options.radiusX||10}set radiusX(t){this.options.radiusX=t}get radiusY(){return this.options.radiusY||5}set radiusY(t){this.options.radiusY=t}get points(){return this.options.points||[]}set points(t){this.options.points=t}get x2(){return this.options.x2||this.gameObject.getGlobalX()+10}set x2(t){this.options.x2=t}get y2(){return this.options.y2||this.gameObject.getGlobalY()}set y2(t){this.options.y2=t}get size(){return this.options.size||20}set size(t){this.options.size=t}draw(t){let e=this.gameObject.getGlobalX(),i=this.gameObject.getGlobalY();switch(this.shape){case"rectangle":case"square":this.drawRect(t,e,i);break;case"circle":this.drawCircle(t,e,i);break;case"ellipse":this.drawEllipse(t,e,i);break;case"line":this.drawLine(t,e,i);break;case"triangle":this.drawTriangle(t,e,i);break;case"polygon":this.drawPolygon(t,e,i);break;default:this.drawRect(t,e,i);break}}drawRect(t,e,i){let{width:o=10,height:n=10,color:r="black"}=this.options;t.fillStyle=r,t.fillRect(e,i,o,n)}drawCircle(t,e,i){let{radius:o=10,color:n="black"}=this.options;t.beginPath(),t.arc(e,i,o,0,Math.PI*2),t.fillStyle=n,t.fill()}drawEllipse(t,e,i){let{radiusX:o=10,radiusY:n=5,color:r="black"}=this.options;t.beginPath(),t.ellipse(e,i,o,n,0,0,Math.PI*2),t.fillStyle=r,t.fill()}drawLine(t,e,i){let{x2:o=e+10,y2:n=i,color:r="black",width:c=2}=this.options;t.strokeStyle=r,t.lineWidth=c,t.beginPath(),t.moveTo(e,i),t.lineTo(o,n),t.stroke()}drawTriangle(t,e,i){let{size:o=20,color:n="black"}=this.options;t.fillStyle=n,t.beginPath(),t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o/2,i-o),t.closePath(),t.fill()}drawPolygon(t,e,i){let{points:o=[],color:n="black"}=this.options;if(!(o.length<3)){t.fillStyle=n,t.beginPath(),t.moveTo(e+o[0][0],i+o[0][1]);for(let r=1;r<o.length;r++)t.lineTo(e+o[r][0],i+o[r][1]);t.closePath(),t.fill()}}};var D=class s extends h{constructor(t=null,e=null,i=!1){super(),this.width=t,this.height=e,this.trigger=i}checkCollisionWith(t){return t instanceof s?this.checkBoxBoxCollision(t):t instanceof CircleColliderComponent?t.checkCollisionWith(this):!1}checkBoxBoxCollision(t){let e=this.getBounds(),i=t.getBounds();return e.x<i.x+i.width&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y}getBounds(){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY(),i=this.width,o=this.height,n=this.gameObject.getComponent(g)?.sprite;return(i===null||o===null)&&n&&(i=i??n.width,o=o??n.height),{x:t,y:e,width:i,height:o}}};var _=class s extends h{constructor(t=null,e=!1){super(),this.radius=t,this.trigger=e}checkCollisionWith(t){if(t instanceof s){let e=this.getBounds(),i=t.getBounds(),o=e.x-i.x,n=e.y-i.y;return Math.hypot(o,n)<e.radius+i.radius}else return this.circleBoxCollision(t)}circleBoxCollision(t){let e=this.getBounds(),i=t.getBounds(),o=Math.max(i.x,Math.min(e.x,i.x+i.width)),n=Math.max(i.y,Math.min(e.y,i.y+i.height)),r=e.x-o,c=e.y-n;return r*r+c*c<e.radius*e.radius}getBounds(){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY(),i=this.radius,o=this.gameObject.getComponent(g)?.sprite;return i===null&&o&&(i=o.width/2),{x:t,y:e,radius:i}}};var B=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}};var wt=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},yt=class extends B{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},bt=class v{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>v.keys.add(t.key)),window.addEventListener("keyup",t=>v.keys.delete(t.key))}static isKeyDown(t){return v.keys.has(t)}},U=class extends B{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){O.instance.register(this)}destroy(){O.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},O=class Q{constructor(){this.colliders=new Set,Q.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof U&&e instanceof U?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};O.instance=void 0;var Ct=class V{#t=!1;constructor(t){V.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new wt,this.#t=!1,new O}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){bt.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(yt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};Ct.instance=null;var Z=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}},xt=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},vt=class extends Z{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},kt=class k{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>k.keys.add(t.key)),window.addEventListener("keyup",t=>k.keys.delete(t.key))}static isKeyDown(t){return k.keys.has(t)}},q=class extends Z{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){R.instance.register(this)}destroy(){R.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},R=class tt{constructor(){this.colliders=new Set,tt.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof q&&e instanceof q?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};R.instance=void 0;var Et=class et{#t=!1;constructor(t){et.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new xt,this.#t=!1,new R}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){kt.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(vt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};Et.instance=null;var st=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}},St=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},Tt=class extends st{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},jt=class E{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>E.keys.add(t.key)),window.addEventListener("keyup",t=>E.keys.delete(t.key))}static isKeyDown(t){return E.keys.has(t)}},$=class extends st{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){N.instance.register(this)}destroy(){N.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},N=class it{constructor(){this.colliders=new Set,it.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof $&&e instanceof $?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};N.instance=void 0;var Ot=class ot{#t=!1;constructor(t){ot.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new St,this.#t=!1,new N}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){jt.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(Tt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};Ot.instance=null;var nt=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}},Rt=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},Nt=class extends nt{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},zt=class S{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>S.keys.add(t.key)),window.addEventListener("keyup",t=>S.keys.delete(t.key))}static isKeyDown(t){return S.keys.has(t)}},K=class extends nt{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){z.instance.register(this)}destroy(){z.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},z=class rt{constructor(){this.colliders=new Set,rt.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof K&&e instanceof K?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};z.instance=void 0;var Gt=class at{#t=!1;constructor(t){at.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new Rt,this.#t=!1,new z}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){zt.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(Nt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};Gt.instance=null;var ht=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}},Mt=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},Bt=class extends ht{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},Ft=class T{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>T.keys.add(t.key)),window.addEventListener("keyup",t=>T.keys.delete(t.key))}static isKeyDown(t){return T.keys.has(t)}},H=class extends ht{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){G.instance.register(this)}destroy(){G.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},G=class lt{constructor(){this.colliders=new Set,lt.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof H&&e instanceof H?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};G.instance=void 0;var At=class ct{#t=!1;constructor(t){ct.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new Mt,this.#t=!1,new G}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){Ft.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(Bt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};At.instance=null;var dt=class{constructor(){this.gameObject=null,this.enabled=!0,this._started=!1}start(){}update(s){}draw(s){}async preload(){}destroy(){}lateUpdate(s){}},It=class{constructor(){this.sheets=new Map}add(s){this.sheets.set(s.name,s)}async preload(){for(let s of this.sheets.values())await s.load()}getSheet(s){return this.sheets.get(s)}},Wt=class extends dt{constructor(s,t=1){super(),this.canvas=s,this.zoom=t}applyTransform(s){let t=this.gameObject.getGlobalX(),e=this.gameObject.getGlobalY();s.setTransform(this.zoom,0,0,this.zoom,-t*this.zoom+this.canvas.width/2,-e*this.zoom+this.canvas.height/2)}},Pt=class j{static keys=new Set;static initialize(){window.addEventListener("keydown",t=>j.keys.add(t.key)),window.addEventListener("keyup",t=>j.keys.delete(t.key))}static isKeyDown(t){return j.keys.has(t)}},J=class extends dt{constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){M.instance.register(this)}destroy(){M.instance.unregister(this)}checkCollisionWith(s){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}},M=class mt{constructor(){this.colliders=new Set,mt.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof J&&e instanceof J?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};M.instance=void 0;var Lt=class pt{#t=!1;constructor(t){pt.instance=this,this.canvas=t,this.ctx=t.getContext("2d"),this.scene=null,this.lastTime=0,this.mainCamera=null,this.spriteRegistry=new It,this.#t=!1,new M}launch(t){if(!t)throw new Error("No scene assigned to game.");this.#n(),this.#e(t)}async#e(t){await this.loadScene(t),this.start()}async loadScene(t){if(!t)throw new Error("No scene provided.");this.scene=t,typeof t._create=="function"&&(t._create(t),t._create=null),await this.spriteRegistry.preload(),await this.scene.preload(),await this.scene.start(),this.start()}start(){Pt.initialize(),this.#o(),requestAnimationFrame(this.loop.bind(this))}loop(t){let e=(t-this.lastTime)/1e3;if(e>.1&&(e=.1),this.lastTime=t,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(this.scene.update(e),this.mainCamera){let i=this.mainCamera.getComponent(Wt);i&&i.applyTransform(this.ctx)}this.scene.draw(this.ctx)}requestAnimationFrame(this.loop.bind(this))}#s(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#i(){this.#t!==!1&&(this.#t=!1,this.lastTime=performance.now(),console.log("Game fullscale resume"))}#o(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#s():this.#i()})}#n(){if(!this.canvas){console.warn("No canvas element provided.");return}this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1}};Lt.instance=null;var Xe={FollowTarget,MovementController};var gt=class extends B{constructor(t){super(),this.target=t}update(){this.target&&(this.gameObject.x=this.target.x)}};var us={FollowTarget,MovementComponent};export{D as BoxColliderComponent,y as CameraComponent,_ as CircleColliderComponent,a as Component,gt as FollowTarget,d as Game,I as GameObject,X as ImageComponent,m as Input,P as MovementComponent,C as RigidbodyComponent,W as Scene,Y as ShapeComponent,x as Sprite,F as SpriteAnimationClip,A as SpriteAnimationComponent,w as SpriteRegistry,g as SpriteRendererComponent,L as Spritesheet,us as plugins};

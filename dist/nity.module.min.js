var B=Object.defineProperty;var Pt=Object.getOwnPropertyDescriptor;var Lt=Object.getOwnPropertyNames;var Dt=Object.prototype.hasOwnProperty;var l=(s,t)=>B(s,"name",{value:t,configurable:!0});var Q=(s,t)=>()=>(s&&(t=s(s=0)),t);var zt=(s,t)=>{for(var e in t)B(s,e,{get:t[e],enumerable:!0})},Et=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Lt(t))!Dt.call(s,o)&&o!==e&&B(s,o,{get:()=>t[o],enumerable:!(i=Pt(t,o))||i.enumerable});return s};var kt=s=>Et(B({},"__esModule",{value:!0}),s);var $,W=Q(()=>{$=class{static{l(this,"Tile")}constructor(t,e,i={}){this.name=t,this.spriteName=e,this.width=i.width||null,this.height=i.height||null,this.opacity=i.opacity!==void 0?i.opacity:1,this.color=i.color||"#FFFFFF",this.flipX=i.flipX||!1,this.flipY=i.flipY||!1,this.collider=i.collider?{width:i.collider.width||null,height:i.collider.height||null,radius:i.collider.radius||null,trigger:i.collider.trigger||!1,type:i.collider.type||"box"}:null}hasCollision(){return this.collider!==null}isTrigger(){return this.collider&&this.collider.trigger}isSolid(){return this.collider&&!this.collider.trigger}getColliderType(){return this.collider?this.collider.type:null}clone(t={}){let e={width:this.width,height:this.height,opacity:this.opacity,color:this.color,flipX:this.flipX,flipY:this.flipY,collider:this.collider?{...this.collider}:null,...t};return new this.constructor(t.name||this.name,t.spriteName||this.spriteName,e)}toString(){let t=this.hasCollision()?` (${this.isTrigger()?"trigger":"solid"})`:"";return`Tile[${this.name}: ${this.spriteName}${t}]`}}});var I,U=Q(()=>{I=class{static{l(this,"TileRegistry")}static tiles=new Map;static _addTile(t,e){this.tiles.set(t,e)}static getTile(t){return this.tiles.get(t)||null}static hasTile(t){return this.tiles.has(t)}static getAllTileNames(){return Array.from(this.tiles.keys())}static getAllTiles(){return Array.from(this.tiles.values())}static removeTile(t){return this.tiles.delete(t)}static clear(){this.tiles.clear()}static getCount(){return this.tiles.size}static registerTile(t,e){return this.hasTile(t)?(console.warn(`TileRegistry: Tile "${t}" already exists. Use forceRegisterTile() to override.`),!1):(this.tiles.set(t,e),!0)}static forceRegisterTile(t,e){this.tiles.set(t,e)}static createTilesFromMetadata(t){let{TileAsset:e}=(et(),kt(lt));return t.map(i=>e.meta(i))}static exportAllToMetadata(){return Array.from(this.tiles.values()).map(t=>t.toMeta?t.toMeta():{name:t.name,spriteName:t.spriteName,options:{width:t.width,height:t.height,opacity:t.opacity,color:t.color,flipX:t.flipX,flipY:t.flipY,collider:t.collider}})}static getTilesByFilter(t){return Array.from(this.tiles.values()).filter(t)}static debugPrint(t=!1){console.log(`TileRegistry: ${this.getCount()} tiles registered`),t?this.tiles.forEach((e,i)=>{console.log(`  - ${i}: ${e.toString()}`)}):console.log(`  Names: [${this.getAllTileNames().join(", ")}]`)}}});var lt={};zt(lt,{TileAsset:()=>it});var it,et=Q(()=>{W();U();it=class s extends ${static{l(this,"TileAsset")}constructor(t,e,i={}){if(t.includes(":"))throw new Error(`TileAsset name "${t}" cannot contain colons. Colons are reserved for potential future tile notation.`);super(t,e,i),this._registerSelf()}_registerSelf(){I._addTile(this.name,this)}static meta(t){if(!t.name||typeof t.name!="string"||t.name.trim()==="")throw new Error("TileAsset.meta() requires a valid name string");if(!t.spriteName||typeof t.spriteName!="string"||t.spriteName.trim()==="")throw new Error("TileAsset.meta() requires a valid spriteName string");return new s(t.name,t.spriteName,t.options||{})}static getDefaultMeta(){return{name:"",spriteName:"",options:{width:null,height:null,opacity:1,color:"#FFFFFF",flipX:!1,flipY:!1,collider:null}}}toMeta(){return{name:this.name,spriteName:this.spriteName,options:{width:this.width,height:this.height,opacity:this.opacity,color:this.color,flipX:this.flipX,flipY:this.flipY,collider:this.collider?{...this.collider}:null}}}applyMeta(t){if(t.name!==void 0&&(this.name=t.name),t.spriteName!==void 0&&(this.spriteName=t.spriteName),t.options){let e=t.options;e.width!==void 0&&(this.width=e.width),e.height!==void 0&&(this.height=e.height),e.opacity!==void 0&&(this.opacity=e.opacity),e.color!==void 0&&(this.color=e.color),e.flipX!==void 0&&(this.flipX=e.flipX),e.flipY!==void 0&&(this.flipY=e.flipY),e.collider!==void 0&&(this.collider=e.collider?{...e.collider}:null)}}}});var C=class{static{l(this,"SpriteRegistry")}static sprites=new Map;static spritesheets=new Map;static _addSprite(t,e){this.sprites.set(t,e)}static _addSpritesheet(t,e){this.spritesheets.set(t,e)}static getSprite(t){return this.sprites.get(t)||null}static getSpritesheet(t){return this.spritesheets.get(t)||null}static async preloadAll(){let t=Array.from(this.sprites.values()).filter(i=>i.load&&typeof i.load=="function").map(i=>i.isLoaded?Promise.resolve():i.load()),e=Array.from(this.spritesheets.values()).map(i=>i.isLoaded?Promise.resolve():i.load());await Promise.all([...t,...e])}static hasSprite(t){return this.sprites.has(t)}static hasSpritesheet(t){return this.spritesheets.has(t)}static getSpriteNames(){return Array.from(this.sprites.keys())}static getSpritesheetNames(){return Array.from(this.spritesheets.keys())}static getSpritesFromSheet(t){let e=[];for(let i of this.sprites.keys())i.startsWith(t+":")&&e.push(i);return e}static clear(){this.sprites.clear(),this.spritesheets.clear()}static removeSprite(t){return this.sprites.delete(t)}static removeSpritesheet(t){return this.spritesheets.delete(t)}constructor(){this.sheets=new Map,console.warn("SpriteRegistry instance methods are deprecated. Use static methods instead.")}add(t){console.warn("SpriteRegistry.add() is deprecated. Use new SpritesheetAsset() instead."),this.sheets.set(t.name,t)}async preload(){console.warn("SpriteRegistry.preload() is deprecated. Use SpriteRegistry.preloadAll() instead.");for(let t of this.sheets.values())await t.load()}getSheet(t){return console.warn("SpriteRegistry.getSheet() is deprecated. Use SpriteRegistry.getSpritesheet() instead."),this.sheets.get(t)}};var p=class{static{l(this,"Component")}constructor(){this.gameObject=null,this.enabled=!0,this._started=!1,this._internalGizmos=this._internalGizmos||(m.instance?._internalGizmos??!1),this.__meta=this.constructor.getDefaultMeta(),arguments.length>0&&this._applyConstructorArgs(...arguments)}static meta(t){let e=new this;return e.applyMeta(t),e}applyMeta(t){let e={...this.__meta,...t};this.__meta=e,this._updatePropertiesFromMeta(),this._validateMeta()}static getDefaultMeta(){return{}}_applyConstructorArgs(...t){}_updatePropertiesFromMeta(){}_validateMeta(){}__lateStart(){}__update(){}__draw(t){this.enabled&&typeof this.draw=="function"&&this.draw(t),this._internalGizmos&&this.__internalGizmos(t),this.OnDrawGizmos&&typeof this.OnDrawGizmos=="function"&&this.OnDrawGizmos(t)}__preload(){}__internalGizmos(t){}start(){}update(){}draw(t){}async preload(){}destroy(){}lateUpdate(){}},rt=class extends p{static{l(this,"MonoBehaviour")}constructor(){super()}};var y=class s{static{l(this,"Vector2")}constructor(t=0,e=0){this.x=t,this.y=e}static get zero(){return new s(0,0)}static get one(){return new s(1,1)}static get up(){return new s(0,1)}static get down(){return new s(0,-1)}static get left(){return new s(-1,0)}static get right(){return new s(1,0)}static get positiveInfinity(){return new s(1/0,1/0)}static get negativeInfinity(){return new s(-1/0,-1/0)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get sqrMagnitude(){return this.x*this.x+this.y*this.y}get normalized(){let t=this.magnitude;return t===0?s.zero:new s(this.x/t,this.y/t)}add(t){return new s(this.x+t.x,this.y+t.y)}subtract(t){return new s(this.x-t.x,this.y-t.y)}multiply(t){return new s(this.x*t,this.y*t)}divide(t){if(t===0)throw new Error("Cannot divide by zero");return new s(this.x/t,this.y/t)}normalize(){let t=this.magnitude;return t===0?(this.x=0,this.y=0):(this.x/=t,this.y/=t),this}set(t,e){return this.x=t,this.y=e,this}clone(){return new s(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}toString(){return`(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}static dot(t,e){return t.x*e.x+t.y*e.y}static distance(t,e){let i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)}static sqrDistance(t,e){let i=t.x-e.x,o=t.y-e.y;return i*i+o*o}static lerp(t,e,i){return i=Math.max(0,Math.min(1,i)),new s(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i)}static lerpUnclamped(t,e,i){return new s(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i)}static min(t,e){return new s(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new s(Math.max(t.x,e.x),Math.max(t.y,e.y))}static moveTowards(t,e,i){let o=e.subtract(t),r=o.magnitude;return r<=i||r===0?e.clone():t.add(o.divide(r).multiply(i))}static reflect(t,e){let i=-2*s.dot(e,t);return new s(i*e.x+t.x,i*e.y+t.y)}static angle(t,e){let i=Math.sqrt(t.sqrMagnitude*e.sqrMagnitude);if(i<1e-15)return 0;let o=Math.max(-1,Math.min(1,s.dot(t,e)/i));return Math.acos(o)}static signedAngle(t,e){let i=s.angle(t,e),o=Math.sign(t.x*e.y-t.y*e.x);return i*o}static clampMagnitude(t,e){let i=t.sqrMagnitude;if(i>e*e){let o=Math.sqrt(i),r=t.x/o,n=t.y/o;return new s(r*e,n*e)}return t.clone()}static rotate(t,e){let i=Math.cos(e),o=Math.sin(e);return new s(t.x*i-t.y*o,t.x*o+t.y*i)}static perpendicular(t){return new s(-t.y,t.x)}static smoothDamp(t,e,i,o,r=1/0,n){o=Math.max(1e-4,o);let a=2/o,h=a*n,c=1/(1+h+.48*h*h+.235*h*h*h),d=t.x-e.x,u=t.y-e.y,f=e.clone(),g=r*o,x=g*g,S=d*d+u*u;if(S>x){let Y=Math.sqrt(S);d=d/Y*g,u=u/Y*g}let z=t.x-d,N=t.y-u,q=(i.x+a*d)*n,R=(i.y+a*u)*n;i.x=(i.x-a*q)*c,i.y=(i.y-a*R)*c;let L=z+(d+q)*c,D=N+(u+R)*c,X=f.x-t.x,E=f.y-t.y,k=L-f.x,A=D-f.y;return X*k+E*A>0&&(L=f.x,D=f.y,i.x=(L-f.x)/n,i.y=(D-f.y)/n),new s(L,D)}};var G=class extends p{static{l(this,"CameraComponent")}constructor(t,e=1){super(),this.canvas=t,this.zoom=e}static getDefaultMeta(){return{zoom:1}}_applyConstructorArgs(t,e=1){let i={zoom:e};this.canvas=t,this.applyMeta(i)}_updatePropertiesFromMeta(){this.zoom=this.__meta.zoom}_validateMeta(){let t=this.__meta;if(typeof t.zoom!="number"||t.zoom<=0)throw new Error("zoom must be a positive number")}applyTransform(t){let e=this.gameObject.getGlobalPosition();t.setTransform(this.zoom,0,0,this.zoom,-e.x*this.zoom+this.canvas.width/2,-e.y*this.zoom+this.canvas.height/2)}};var M=class s{static{l(this,"Input")}static keys=new Set;static pressedKeys=new Set;static releasedKeys=new Set;static previousKeys=new Set;static mouseButtons=new Set;static pressedMouseButtons=new Set;static releasedMouseButtons=new Set;static previousMouseButtons=new Set;static mousePosition={x:0,y:0};static lastMousePosition={x:0,y:0};static onKeyDown=new Map;static onKeyStay=new Map;static onKeyUp=new Map;static onMouseDown=new Map;static onMouseStay=new Map;static onMouseUp=new Map;static onMouseMove=new Set;static canvas=null;static initialize(t=null){s.canvas=t,window.addEventListener("keydown",i=>{let o=i.key.toLowerCase();if(!s.keys.has(o)){s.pressedKeys.add(o);let r=s.onKeyDown.get(o);r&&r(o)}s.keys.add(o)}),window.addEventListener("keyup",i=>{let o=i.key.toLowerCase();s.keys.delete(o),s.releasedKeys.add(o);let r=s.onKeyUp.get(o);r&&r(o)});let e=t||window;e.addEventListener("mousedown",i=>{let o=i.button;if(!s.mouseButtons.has(o)){s.pressedMouseButtons.add(o);let r=s.onMouseDown.get(o);r&&r(o,s.mousePosition)}s.mouseButtons.add(o),s.updateMousePosition(i)}),e.addEventListener("mouseup",i=>{let o=i.button;s.mouseButtons.delete(o),s.releasedMouseButtons.add(o);let r=s.onMouseUp.get(o);r&&r(o,s.mousePosition),s.updateMousePosition(i)}),e.addEventListener("mousemove",i=>{s.updateMousePosition(i);for(let o of s.onMouseMove)o(s.mousePosition,s.lastMousePosition)}),t&&t.addEventListener("contextmenu",i=>i.preventDefault())}static updateMousePosition(t){if(s.lastMousePosition={...s.mousePosition},s.canvas){let e=s.canvas.getBoundingClientRect();s.mousePosition.x=t.clientX-e.left,s.mousePosition.y=t.clientY-e.top}else s.mousePosition.x=t.clientX,s.mousePosition.y=t.clientY}static update(){for(let t of s.keys)if(s.previousKeys.has(t)){let e=s.onKeyStay.get(t);e&&e(t)}for(let t of s.mouseButtons)if(s.previousMouseButtons.has(t)){let e=s.onMouseStay.get(t);e&&e(t,s.mousePosition)}s.pressedKeys.clear(),s.releasedKeys.clear(),s.pressedMouseButtons.clear(),s.releasedMouseButtons.clear(),s.previousKeys=new Set(s.keys),s.previousMouseButtons=new Set(s.mouseButtons)}static isKeyDown(t){return s.keys.has(t.toLowerCase())}static isKeyPressed(t){return s.pressedKeys.has(t.toLowerCase())}static isKeyReleased(t){return s.releasedKeys.has(t.toLowerCase())}static isMouseDown(t=0){return s.mouseButtons.has(t)}static isMousePressed(t=0){return s.pressedMouseButtons.has(t)}static isMouseReleased(t=0){return s.releasedMouseButtons.has(t)}static getMousePosition(){return{...s.mousePosition}}static getMouseDelta(){return{x:s.mousePosition.x-s.lastMousePosition.x,y:s.mousePosition.y-s.lastMousePosition.y}}static isLeftMouseDown(){return s.isMouseDown(0)}static isLeftMousePressed(){return s.isMousePressed(0)}static isRightMouseDown(){return s.isMouseDown(2)}static isRightMousePressed(){return s.isMousePressed(2)}static onKeyDownEvent(t,e){s.onKeyDown.set(t.toLowerCase(),e)}static onKeyStayEvent(t,e){s.onKeyStay.set(t.toLowerCase(),e)}static onKeyUpEvent(t,e){s.onKeyUp.set(t.toLowerCase(),e)}static onMouseDownEvent(t=0,e){s.onMouseDown.set(t,e)}static onMouseStayEvent(t=0,e){s.onMouseStay.set(t,e)}static onMouseUpEvent(t=0,e){s.onMouseUp.set(t,e)}static onMouseMoveEvent(t){s.onMouseMove.add(t)}static onLeftClickEvent(t){s.onMouseDownEvent(0,t)}static onRightClickEvent(t){s.onMouseDownEvent(2,t)}static removeKeyEvent(t,e){let i=e.toLowerCase();switch(t){case"down":s.onKeyDown.delete(i);break;case"stay":s.onKeyStay.delete(i);break;case"up":s.onKeyUp.delete(i);break}}static removeMouseEvent(t,e){switch(t){case"down":s.onMouseDown.delete(e);break;case"stay":s.onMouseStay.delete(e);break;case"up":s.onMouseUp.delete(e);break;case"move":s.onMouseMove.delete(e);break}}static clearAllEvents(){s.onKeyDown.clear(),s.onKeyStay.clear(),s.onKeyUp.clear(),s.onMouseDown.clear(),s.onMouseStay.clear(),s.onMouseUp.clear(),s.onMouseMove.clear()}};var b=class extends p{static{l(this,"AbstractColliderComponent")}constructor(){super(),this.trigger=!1,this._lastCollisions=new Set}isTrigger(){return this.trigger===!0}start(){w.instance.register(this)}destroy(){w.instance.unregister(this)}checkCollisionWith(t){throw new Error("checkCollisionWith must be implemented")}getBounds(){throw new Error("getBounds must be implemented")}};var w=class s{static{l(this,"CollisionSystem")}constructor(){this.colliders=new Set,s.instance=this}register(t){this.colliders.add(t)}unregister(t){this.colliders.delete(t)}update(){}intersects(t,e){return t instanceof b&&e instanceof b?t.checkCollisionWith(e):(console.warn("INTERNAL_ERROR:At least one object is not an collider component:",t,e),!1)}};w.instance=void 0;var F=class s{static{l(this,"GameObject")}constructor(t=0,e=0){t instanceof y?this.position=t.clone():this.position=new y(t,e),this.rotation=0,this.components=[],this.children=[],this.parent=null,this.name="",this.tags=new Set,this.paused=!1,this.layer="default",this.zIndex=0}addComponent(t){if(!(t instanceof p))throw new Error('addComponent: property "component" must be an instance of Component');if(this.getComponent(t.constructor))throw new Error(`Component of type ${t.constructor.name} already exists on this GameObject.`);return t.gameObject=this,this.components.push(t),t}addComponents(t){if(!Array.isArray(t))throw new Error('addComponents: property "components" must be an array of Component instances');for(let i of t){if(!(i instanceof p))throw new Error("addComponents: all items must be instances of Component");if(this.getComponent(i.constructor))throw new Error(`Component of type ${i.constructor.name} already exists on this GameObject.`)}let e=[];for(let i of t)i.gameObject=this,this.components.push(i),e.push(i);return e}getComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('getComponent: property "type" must be a class');return this.components.find(e=>e instanceof t)}hasComponent(t){if(typeof t!="function"||!t.prototype)throw new Error('hasComponent: property "type" must be a class');return!!this.getComponent(t)}removeComponent(t){let e=this.components.findIndex(i=>i instanceof t);e!==-1&&(this.components[e].destroy?.(),this.components.splice(e,1))}getComponentInChildren(t){if(typeof t!="function"||!t.prototype)throw new Error('hasComponent: property "type" must be a class');return this.children.find(e=>e.hasComponent(t)).getComponent(t)}hasTag(t){return this.tags.has(t)}addTag(t){this.tags.add(t)}__addChild(t){if(!(t instanceof s))throw new Error(`Nity2D: method 'addChild' only accepts GameObject, '${typeof t}' provided`);this.children.push(t),t.parent=this}addChild(t){P.create(t,{parent:this,addToScene:!0})}addChildren(t){if(!Array.isArray(t))throw new Error(`Nity2D: method 'addChildren' only accepts array '${typeof t}' provided`);t.forEach(e=>this.addChild(e))}removeChild(t){let e=this.children.indexOf(t);e!==-1&&(t.parent=null,this.children.splice(e,1))}getGlobalPosition(){return this.parent?this.position.add(this.parent.getGlobalPosition()):this.position.clone()}getGlobalRotation(){return this.parent?this.rotation+this.parent.getGlobalRotation():this.rotation}setPosition(t,e){t instanceof y?this.position.set(t.x,t.y):this.position.set(t,e)}setRotation(t){this.rotation=t}setRotationDegrees(t){this.rotation=t*(Math.PI/180)}getRotationDegrees(){return this.rotation*(180/Math.PI)}getGlobalRotationDegrees(){return this.getGlobalRotation()*(180/Math.PI)}rotate(t){this.rotation+=t}rotateDegrees(t){this.rotation+=t*(Math.PI/180)}translate(t,e){t instanceof y?this.position=this.position.add(t):this.position=this.position.add(new y(t,e))}async preload(){let t=this.components.map(e=>e.preload?.());for(let e of this.children)t.push(e.preload?.());await Promise.all(t)}start(){for(let t of this.components)t.enabled&&typeof t.start=="function"&&t.start();for(let t of this.children)t.start()}update(){if(!this.paused){for(let t of this.components)t.enabled&&typeof t.update=="function"&&t.update();for(let t of this.children)t.update()}}lateUpdate(){if(!this.paused){for(let t of this.components)t.enabled&&typeof t.lateUpdate=="function"&&t.lateUpdate();for(let t of this.children)t.lateUpdate()}}onCollisionEnter(t){for(let e of this.components)typeof e.onCollisionEnter=="function"&&e.onCollisionEnter(t)}onCollisionStay(t){for(let e of this.components)typeof e.onCollisionStay=="function"&&e.onCollisionStay(t)}onCollisionExit(t){for(let e of this.components)typeof e.onCollisionExit=="function"&&e.onCollisionExit(t)}__draw(t){if(!this.paused){for(let e of this.components)e.__draw(t);for(let e of this.children)e.__draw(t)}}};var P=class s{static{l(this,"Instantiate")}static create(t,e={},...i){let{x:o,y:r,parent:n=null,addToScene:a=!0}=e,h;if(typeof t=="function")h=new t(o??0,r??0,...i);else if(t instanceof F)h=t,o!==void 0&&(h.x=o),r!==void 0&&(h.y=r);else throw new Error("Instantiate.create: prefab must be a GameObject instance or constructor function");if(n){if(!(n instanceof F))throw new Error("Instantiate.create: parent must be a GameObject instance");n.__addChild(h)}if(a&&!n&&m.instance?.scene&&(m.instance.scene.__addObjectToScene(h),m.instance.hasLayerSystem())){let c=h.layer||m.instance.getDefaultLayer();m.instance.addToLayer(c,h)}return s._registerGameObject(h),h}static _registerGameObject(t){for(let e of t.components)s._registerComponent(e);for(let e of t.children)s._registerGameObject(e)}static _registerComponent(t){t instanceof b&&(w.instance?w.instance.register(t):(console.warn("CollisionSystem not initialized. Collider will be registered when system is available:",t),s._pendingColliders||(s._pendingColliders=[]),s._pendingColliders.push(t))),typeof t.start=="function"&&t.start()}static registerPendingColliders(){if(s._pendingColliders&&w.instance){for(let t of s._pendingColliders)w.instance.register(t);s._pendingColliders=[]}}static destroy(t){if(!(t instanceof F))throw new Error("Instantiate.destroy: gameObject must be a GameObject instance");for(let e of[...t.children])s.destroy(e);for(let e of t.components)s._unregisterComponent(e);if(t.parent&&t.parent.removeChild(t),m.instance?.scene){let e=m.instance.scene.objects.indexOf(t);e!==-1&&m.instance.scene.objects.splice(e,1)}}static _unregisterComponent(t){t instanceof b&&w.instance&&w.instance.unregister(t),typeof t.destroy=="function"&&t.destroy()}static clone(t,e={}){if(!(t instanceof F))throw new Error("Instantiate.clone: original must be a GameObject instance");let i=new F(t.x,t.y);i.name=t.name,i.tags=new Set(t.tags);for(let h of t.components){let c=h.constructor,d=new c;for(let u in h)h.hasOwnProperty(u)&&u!=="gameObject"&&(d[u]=h[u]);i.addComponent(d)}for(let h of t.children){let c=s.clone(h,{addToScene:!1});i.__addChild(c)}let{x:o=i.x,y:r=i.y,parent:n=null,addToScene:a=!0}=e;return i.x=o,i.y=r,n&&n.__addChild(i),a&&!n&&m.instance?.scene&&m.instance.scene.__addObjectToScene(i),s._registerGameObject(i),i}};var v=class{static{l(this,"Time")}static#t=performance.now();static#o=performance.now();static#i=0;static#n=1e3;static#s=performance.now();static#r=60;static#e=1;static get deltaTime(){return m.instance?._deltaTime||0}static get unscaleddeltaTime(){return(m.instance?._deltaTime||0)/this.#e}static get time(){return(performance.now()-this.#t)/1e3*this.#e}static get unscaledTime(){return(performance.now()-this.#t)/1e3}static get fps(){return this.#r}static get frameCount(){return this.#i}static get timeScale(){return this.#e}static set timeScale(t){this.#e=Math.max(0,t)}static get timestamp(){return performance.now()}static get realtimeSinceStartup(){return Date.now()}static _updateTimeStats(){let t=performance.now();if(this.#i++,t-this.#s>=this.#n){let e=t-this.#s,i=this.#i-(this.#s===performance.now()?0:Math.floor(e/16.67));this.#r=Math.round(1e3/(e/i))||60,this.#s=t}this.#o=t}static secondsToMilliseconds(t){return t*1e3}static millisecondsToSeconds(t){return t/1e3}static createTimer(t){let e=this.time;return()=>this.time-e>=t}static createInterval(t){let e=this.time;return()=>this.time-e>=t?(e=this.time,!0):!1}static lerp(t,e,i){return t+(e-t)*(1-Math.exp(-i*this.deltaTime))}static _reset(){this.#t=performance.now(),this.#o=performance.now(),this.#i=0,this.#s=performance.now(),this.#r=60,this.#e=1}};var O=[];function At(s,t=0){if(t<=0)tt(s);else{let e=performance.now()+t*1e3;O.push({target:s,time:e})}}l(At,"Destroy");function Ot(s,t){if(!s||!s.components){console.warn("DestroyComponent: Invalid GameObject provided");return}let e=s.getComponent(t);e?(typeof e.destroy=="function"&&e.destroy(),s.removeComponent(t),console.log(`DestroyComponent: Removed ${t.name} from ${s.name||"GameObject"}`)):console.warn(`DestroyComponent: Component ${t.name} not found on GameObject`)}l(Ot,"DestroyComponent");function $t(){let s=m.instance;if(!s||!s.currentScene){console.warn("DestroyAll: No active scene found");return}let t=[...s.currentScene.objects];t.forEach(e=>tt(e)),console.log(`DestroyAll: Destroyed ${t.length} GameObjects`)}l($t,"DestroyAll");function tt(s){if(!s){console.warn("Destroy: Cannot destroy null or undefined target");return}s.components&&Array.isArray(s.components)&&s.position?It(s):s.gameObject?Nt(s):(console.warn("Destroy: Unknown target type, cannot destroy",s),console.warn("Target properties:",Object.keys(s)))}l(tt,"_destroyImmediate");function It(s){let t=m.instance;if(!t||!t.currentScene){console.warn("Destroy: No active scene found for GameObject destruction");return}t.currentScene.remove(s),console.log(`Destroy: Destroyed GameObject "${s.name||"Unnamed"}"`)}l(It,"_destroyGameObject");function Nt(s){if(!s.gameObject){console.warn("Destroy: Component has no associated GameObject");return}typeof s.destroy=="function"&&s.destroy();let t=s.constructor;s.gameObject.removeComponent(t),console.log(`Destroy: Destroyed Component ${t.name}`)}l(Nt,"_destroyComponent");function nt(){let s=performance.now(),t=[];for(let e=O.length-1;e>=0;e--){let i=O[e];s>=i.time&&(t.push(i.target),O.splice(e,1))}t.forEach(e=>tt(e))}l(nt,"_processPendingDestructions");function jt(){return O.length}l(jt,"getPendingDestructionCount");function qt(){O=[]}l(qt,"clearPendingDestructions");var j=class{static{l(this,"LayerManager")}constructor(t,e={}){this.mainCanvas=t,this.mainCtx=t.getContext("2d"),this.config={layers:e.layers||["background","default","ui"],defaultLayer:e.defaultLayer||"default",width:e.width||t.width||800,height:e.height||t.height||600,...e},this.layers=new Map,this.layerContexts=new Map,this.layerContents=new Map,this.dirtyLayers=new Set,this.layerOrder=[...this.config.layers],this.layerZIndex=new Map,this.initializeLayers()}initializeLayers(){this.config.layers.forEach((t,e)=>{let i=new OffscreenCanvas(this.config.width,this.config.height),o=i.getContext("2d");this.layers.set(t,i),this.layerContexts.set(t,o),this.layerContents.set(t,[]),this.layerZIndex.set(t,e*100),this.dirtyLayers.add(t)})}addToLayer(t,e){if(!this.layers.has(t)){console.warn(`LayerManager: Layer "${t}" does not exist`);return}let i=this.layerContents.get(t);i.includes(e)||(i.push(e),e.layer!==void 0&&(e.layer=t),this.markLayerDirty(t))}removeFromLayer(t,e){if(!this.layers.has(t))return;let i=this.layerContents.get(t),o=i.indexOf(e);o!==-1&&(i.splice(o,1),this.markLayerDirty(t))}markLayerDirty(t){this.dirtyLayers.add(t)}markAllLayersDirty(){this.config.layers.forEach(t=>{this.dirtyLayers.add(t)})}renderLayer(t){if(!this.dirtyLayers.has(t))return;let e=this.layerContexts.get(t),i=this.layerContents.get(t);if(!e||!i)return;e.clearRect(0,0,this.config.width,this.config.height),i.slice().sort((r,n)=>{let a=r.zIndex||0,h=n.zIndex||0;return a-h}).forEach(r=>{r.active!==!1&&(e.save(),typeof r.__draw=="function"?r.__draw(e):typeof r.draw=="function"&&r.draw(e),e.restore())}),this.dirtyLayers.delete(t)}render(){this.layerOrder.forEach(t=>{this.dirtyLayers.has(t)&&this.renderLayer(t)}),this.mainCtx.clearRect(0,0,this.mainCanvas.width,this.mainCanvas.height),this.layerOrder.forEach(t=>{let e=this.layers.get(t);e&&this.mainCtx.drawImage(e,0,0)})}getLayerZIndex(t){return this.layerZIndex.get(t)||0}setLayerZIndex(t,e){this.layerZIndex.set(t,e),this.layerOrder.sort((i,o)=>this.getLayerZIndex(i)-this.getLayerZIndex(o))}getDefaultLayer(){return this.config.defaultLayer}clearLayer(t){this.layerContents.has(t)&&(this.layerContents.set(t,[]),this.markLayerDirty(t))}clearAllLayers(){this.layerOrder.forEach(t=>{this.clearLayer(t)})}resize(t,e){this.config.width=t,this.config.height=e,this.mainCanvas.width=t,this.mainCanvas.height=e,this.layers.forEach((i,o)=>{let r=new OffscreenCanvas(t,e),n=r.getContext("2d");this.layers.set(o,r),this.layerContexts.set(o,n),this.markLayerDirty(o)})}getLayerContents(t){return this.layerContents.get(t)||[]}hasLayer(t){return this.layers.has(t)}addLayer(t,e){if(this.hasLayer(t)){console.warn(`LayerManager: Layer "${t}" already exists`);return}let i=new OffscreenCanvas(this.config.width,this.config.height),o=i.getContext("2d");this.layers.set(t,i),this.layerContexts.set(t,o),this.layerContents.set(t,[]);let r=e!==void 0?e:this.layerOrder.length*100;this.layerZIndex.set(t,r),this.layerOrder.push(t),this.layerOrder.sort((n,a)=>this.getLayerZIndex(n)-this.getLayerZIndex(a)),this.markLayerDirty(t)}removeLayer(t){if(!this.hasLayer(t))return;this.layers.delete(t),this.layerContexts.delete(t),this.layerContents.delete(t),this.layerZIndex.delete(t),this.dirtyLayers.delete(t);let e=this.layerOrder.indexOf(t);e!==-1&&this.layerOrder.splice(e,1)}getMemoryStats(){let t=this.layers.size,e=Array.from(this.layerContents.values()).reduce((r,n)=>r+n.length,0),i=this.config.width*this.config.height*4,o=t*i;return{layers:t,objects:e,memoryMB:(o/(1024*1024)).toFixed(2),dirtyLayers:this.dirtyLayers.size,canvasElements:1}}getDebugInfo(){let t=this.getMemoryStats();return`LayerManager: ${t.layers} internal layers, ${t.objects} objects, ${t.memoryMB}MB memory, ${t.dirtyLayers} dirty layers, 1 DOM canvas`}};var m=class s{static{l(this,"Game")}#t=!1;#o=!1;#i=!1;#n=0;constructor(t){if(s.instance=this,t!=null){if(!(t instanceof HTMLCanvasElement))throw new Error("Game constructor requires a valid HTMLCanvasElement.");this.canvas=t,this.ctx=t.getContext("2d")}this.scene=null,this.mainCamera=null,this.layerManager=null,this.useLayerSystem=!1,this.paused=!1,this._internalGizmos=!1,this._debugMode=!1,this._deltaTime=0,new w,P.registerPendingColliders()}configure(t={canvas:null,mainCamera:null,debug:!1,layers:null,defaultLayer:null,useLayerSystem:!1}){if(this.#o||this.#i){console.warn("Game is already initialized. Configuration changes will not take effect.");return}if(t.canvas&&(this.canvas=t.canvas,this.ctx=this.canvas.getContext("2d")),t.mainCamera&&(this.mainCamera=t.mainCamera),t.debug&&this.#u(),t.useLayerSystem&&this.canvas){this.useLayerSystem=!0;let e={layers:t.layers||["background","default","ui"],defaultLayer:t.defaultLayer||"default",width:this.canvas.width,height:this.canvas.height};this.layerManager=new j(this.canvas,e),console.log("LayerManager initialized with layers:",e.layers),console.log("Default layer:",e.defaultLayer)}}launch(t){if(!t&&!this.scene)throw new Error("No scene provided.");if(this.#i){console.warn("Game is already launching or has been launched.");return}else this.#i=!0;if(!t&&!this.scene)throw new Error("No scene assigned to game.");this.#d(),this.#s(t||this.scene)}async loadScene(t){if(!t)throw new Error("No scene provided.");if(!this.#o&&!this.#i){await this.#a(t);return}this.#s(t)}pause(){this.paused=!0}resume(){this.paused=!1}async#s(t){await this.#a(t),this.#r()}#r(){v._reset(),M.initialize(this.canvas),this.#c(),requestAnimationFrame(this.#e.bind(this))}#e(t){if(this._deltaTime=(t-this.#n)/1e3,this._deltaTime>.1&&(this._deltaTime=.1),this.#n=t,v._updateTimeStats(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),!this.#t){if(!this.paused&&(M.update(),this.scene.__update(),this.mainCamera)){let e=this.mainCamera.getComponent(G);e&&e.applyTransform(this.ctx)}this.scene.__lateUpdate(),nt(),this.useLayerSystem&&this.layerManager?this.layerManager.render():this.scene.__draw(this.ctx)}requestAnimationFrame(this.#e.bind(this))}async#a(t){if(!t)throw new Error("No scene provided.");this.scene=t,this.currentScene=t,await C.preloadAll(),await this.scene.preload(),await this.scene.start()}#h(){this.#t!==!0&&(this.#t=!0,console.log("Game fullscale pause"))}#l(){this.#t!==!1&&(this.#t=!1,this.#n=performance.now(),console.log("Game fullscale resume"))}#c(){document.addEventListener("visibilitychange",()=>{document.hidden?this.#h():this.#l()})}#d(){if(!this.canvas){console.warn("No canvas element provided.");return}if(this.ctx||console.error("Failed to get 2D context from canvas."),this.ctx.imageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1,this.useLayerSystem&&!this.layerManager){let t={layers:["background","environment","gameplay","effects","ui"],width:this.canvas.width,height:this.canvas.height};this.layerManager=new j(this.canvas,t),console.log("LayerManager initialized in _initCanvas with default layers")}}#u(){this._debugMode=!0,this._internalGizmos=!0}addToLayer(t,e){if(!this.useLayerSystem||!this.layerManager){console.warn("LayerManager not enabled. Use configure({ useLayerSystem: true }) to enable layers.");return}this.layerManager.addToLayer(t,e)}removeFromLayer(t,e){if(!this.useLayerSystem||!this.layerManager){console.warn("LayerManager not enabled.");return}this.layerManager.removeFromLayer(t,e)}getLayerManager(){return this.layerManager}hasLayerSystem(){return this.useLayerSystem&&this.layerManager!==null}getDefaultLayer(){return this.layerManager?this.layerManager.getDefaultLayer():"default"}};m.instance=null;var at=class s{static{l(this,"SpriteAnimationClip")}constructor(t,e=[],i=10,o=!0){this.name=t,this.spriteNames=e,this.fps=i,this.loop=o}static meta(t={}){let i={...this.getDefaultMeta(),...t};return this.validateMeta(i),new this(i.name,i.spriteNames,i.fps,i.loop)}static getDefaultMeta(){return{name:"",spriteNames:[],fps:10,loop:!0}}static validateMeta(t){if(typeof t.name!="string")throw new Error("SpriteAnimationClip metadata: name must be a string");if(t.name.trim()==="")throw new Error("SpriteAnimationClip metadata: name cannot be empty");if(!Array.isArray(t.spriteNames))throw new Error("SpriteAnimationClip metadata: spriteNames must be an array");if(t.spriteNames.some(e=>typeof e!="string"))throw new Error("SpriteAnimationClip metadata: all spriteNames must be strings");if(typeof t.fps!="number"||t.fps<=0)throw new Error("SpriteAnimationClip metadata: fps must be a positive number");if(typeof t.loop!="boolean")throw new Error("SpriteAnimationClip metadata: loop must be a boolean")}applyMeta(t){let i={...this.constructor.getDefaultMeta(),...t};this.constructor.validateMeta(i),this.name=i.name,this.spriteNames=i.spriteNames,this.fps=i.fps,this.loop=i.loop}toMeta(){return{name:this.name,spriteNames:[...this.spriteNames],fps:this.fps,loop:this.loop}}clone(){return new s(this.name,[...this.spriteNames],this.fps,this.loop)}};var K=class extends p{static{l(this,"SpriteRendererComponent")}constructor(t,e={}){super(),this.spriteKey=t,this.sprite=null,this.options={width:e.width||null,height:e.height||null,opacity:e.opacity!==void 0?e.opacity:1,color:e.color||"#FFFFFF",flipX:e.flipX||!1,flipY:e.flipY||!1}}static getDefaultMeta(){return{spriteName:"",width:null,height:null,opacity:1,color:"#FFFFFF",flipX:!1,flipY:!1}}_applyConstructorArgs(t,e={}){let i={spriteName:t||"",width:e.width||null,height:e.height||null,opacity:e.opacity!==void 0?e.opacity:1,color:e.color||"#FFFFFF",flipX:e.flipX||!1,flipY:e.flipY||!1};this.applyMeta(i)}_updatePropertiesFromMeta(){this.__meta.spriteName&&(this.spriteKey=this.__meta.spriteName),this.options={width:this.__meta.width,height:this.__meta.height,opacity:this.__meta.opacity,color:this.__meta.color,flipX:this.__meta.flipX,flipY:this.__meta.flipY}}_validateMeta(){let t=this.__meta;if(typeof t.spriteName!="string")throw new Error("spriteName must be a string");if(t.width!==null&&(typeof t.width!="number"||t.width<=0))throw new Error("width must be null or a positive number");if(t.height!==null&&(typeof t.height!="number"||t.height<=0))throw new Error("height must be null or a positive number");if(typeof t.opacity!="number"||t.opacity<0||t.opacity>1)throw new Error("opacity must be a number between 0 and 1");if(typeof t.color!="string")throw new Error("color must be a string");if(typeof t.flipX!="boolean")throw new Error("flipX must be a boolean");if(typeof t.flipY!="boolean")throw new Error("flipY must be a boolean")}preload(){if(this.sprite=C.getSprite(this.spriteKey),!this.sprite)throw new Error(`Sprite '${this.spriteKey}' not found in SpriteRegistry. Make sure the sprite or spritesheet is loaded.`)}__draw(t){if(!this.sprite||!this.sprite.image||!this.sprite.isLoaded){console.log(`Sprite '${this.spriteKey}' is not loaded or does not exist.`);return}let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation(),o=this.options.width||this.sprite.width,r=this.options.height||this.sprite.height,n=this.options.opacity!==1,a=this.options.color!=="#FFFFFF";n&&(t.save(),t.globalAlpha=Math.max(0,Math.min(1,this.options.opacity)));let h=1,c=1;this.options.flipX&&(h=-1),this.options.flipY&&(c=-1),this.sprite.draw(t,e.x,e.y,o,r,i,h,c),a&&(t.save(),t.globalCompositeOperation="source-atop",t.fillStyle=this.options.color,i!==0?(t.translate(e.x,e.y),t.rotate(i),t.fillRect(-o/2,-r/2,o,r)):t.fillRect(e.x-o/2,e.y-r/2,o,r),t.restore()),n&&t.restore()}setSprite(t){this.spriteKey=t,this.sprite=C.getSprite(t),this.sprite||console.warn(`Sprite '${t}' not found in SpriteRegistry.`)}setScale(t,e){this.options.width=t,this.options.height=e}setOptions(t){this.options={...this.options,...t}}getRenderedWidth(){return this.sprite?this.options.width||this.sprite.width:0}getRenderedHeight(){return this.sprite?this.options.height||this.sprite.height:0}getOpacity(){return this.options.opacity}setOpacity(t){this.options.opacity=Math.max(0,Math.min(1,t))}getColor(){return this.options.color}setColor(t){this.options.color=t}getFlipX(){return this.options.flipX}setFlipX(t){this.options.flipX=t}getFlipY(){return this.options.flipY}setFlipY(t){this.options.flipY=t}__internalGizmos(t){if(!this.sprite||!this.sprite.image||!this.sprite.isLoaded)return;let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),i!==0&&t.rotate(i),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]);let o=this.getRenderedWidth(),r=this.getRenderedHeight();t.strokeRect(-o/2,-r/2,o,r),t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center",t.fillText(this.spriteKey,0,-r/2-8),t.fillText(`${o}x${r}`,0,r/2+15),t.restore()}};var ht=class extends p{static{l(this,"SpriteAnimationComponent")}constructor(t=null){super(),this.clips=new Map,this.currentClip=null,this.currentFrame=0,this.autoPlay=!0,this.time=0,this.defaultClipName=t}static getDefaultMeta(){return{defaultClipName:null,autoPlay:!0}}_applyConstructorArgs(t=null){let e={defaultClipName:t,autoPlay:!0};this.applyMeta(e)}_updatePropertiesFromMeta(){this.defaultClipName=this.__meta.defaultClipName,this.autoPlay=this.__meta.autoPlay}_validateMeta(){let t=this.__meta;if(t.defaultClipName!==null&&typeof t.defaultClipName!="string")throw new Error("defaultClipName must be null or a string");if(typeof t.autoPlay!="boolean")throw new Error("autoPlay must be a boolean")}start(){this.autoPlay&&this.defaultClipName&&this.play(this.defaultClipName)}addClip(t){this.clips.set(t.name,t)}play(t){let e=this.clips.get(t);if(!e)throw new Error(`Animation clip '${t}' not found.`);this.currentClip=e,this.currentFrame=0,this.time=0,this._applyFrame()}update(){if(!this.currentClip)return;this.time+=v.deltaTime;let t=1/this.currentClip.fps;if(this.time>=t){if(this.time-=t,this.currentFrame++,this.currentFrame>=this.currentClip.spriteNames.length)if(this.currentClip.loop)this.currentFrame=0;else{this.currentFrame=this.currentClip.spriteNames.length-1;return}this._applyFrame()}}_applyFrame(){if(!this.currentClip||!this.currentClip.spriteNames[this.currentFrame])return;let t=this.currentClip.spriteNames[this.currentFrame],e=this.gameObject.getComponent(K);e&&e.setSprite(t)}};W();et();U();var ct=class{static{l(this,"Scene")}constructor({create:t}={}){this.objects=[],this._createFn=t}create(t){}add(t){if(P.create(t),m.instance&&m.instance.hasLayerSystem()){let e=t.layer||m.instance.getDefaultLayer();m.instance.addToLayer(e,t)}}remove(t){let e=this.objects.indexOf(t);e>-1&&(typeof t.destroy=="function"&&t.destroy(),t.components&&t.components.forEach(i=>{typeof i.destroy=="function"&&i.destroy()}),this.objects.splice(e,1),t.scene=null)}__addObjectToScene(t){if(!(t instanceof F))throw new Error(`[Nity] Forbidden object '${t?t.constructor.name:null}' added to the scene. Accepts only 'GameObject'.`);this.objects.push(t)}findByName(t){return this.objects.find(e=>e.name===t)}findByTag(t){return this.objects.filter(e=>e.hasTag(t))}async preload(){typeof this._createFn=="function"&&(await this._createFn(this),this._createFn=null),typeof this.create=="function"&&this.create!==this._createFn&&await this.create(this);let t=this.objects.map(e=>e?.preload?.());await Promise.all(t)}async start(){for(let t of this.objects)typeof t?.start=="function"&&t?.start();setTimeout(()=>{},500)}update(){}lateUpdate(){}__update(){for(let t of this.objects)typeof t?.update=="function"&&t?.update();w.instance?w.instance?.update():console.warn("Scene: CollisionSystem.instance is null!"),this?.update()}__lateUpdate(){for(let t of this.objects)typeof t.lateUpdate=="function"&&t?.lateUpdate();this?.lateUpdate()}__draw(t){for(let e of this.objects)e.__draw(t)}};var H=class extends p{static{l(this,"GravityComponent")}constructor(t={gravityScale:300}){super(),this.gravity=!0,this.gravityScale=t.gravityScale||300,this.velocity=new y(0,0)}static getDefaultMeta(){return{gravityScale:300}}_applyConstructorArgs(t={}){let e={gravityScale:t.gravityScale||300};this.applyMeta(e)}_updatePropertiesFromMeta(){this.gravityScale=this.__meta.gravityScale}_validateMeta(){let t=this.__meta;if(typeof t.gravityScale!="number"||t.gravityScale<0)throw new Error("gravityScale must be a non-negative number")}update(){this.gravity&&(this.velocity.y+=this.gravityScale*v.deltaTime)}_doMove(t,e){t instanceof y?this.gameObject.translate(t):this.gameObject.translate(t,e)}};var Z=class s extends H{static{l(this,"RigidbodyComponent")}#t;#o=new Set;bounciness=0;gravity=!1;gravityScale=300;constructor(t={gravity:!1,gravityScale:300,bounciness:0}){super(t),this.gravity=t.gravity!=null?t.gravity:!1,this.bounciness=t.bounciness||0}static getDefaultMeta(){return{gravity:!1,gravityScale:300,bounciness:0}}_applyConstructorArgs(t={}){let e={gravity:t.gravity!==null?t.gravity:!1,gravityScale:t.gravityScale||300,bounciness:t.bounciness||0};this.applyMeta(e)}_updatePropertiesFromMeta(){this.gravity=this.__meta.gravity,this.gravityScale=this.__meta.gravityScale,this.bounciness=this.__meta.bounciness}_validateMeta(){let t=this.__meta;if(typeof t.gravity!="boolean")throw new Error("gravity must be a boolean");if(typeof t.gravityScale!="number"||t.gravityScale<0)throw new Error("gravityScale must be a non-negative number");if(typeof t.bounciness!="number"||t.bounciness<0||t.bounciness>1)throw new Error("bounciness must be a number between 0 and 1")}start(){this.#t=this.gameObject.getComponent(b),this.#t||console.warn("RigidbodyComponent requires a collider.")}update(){super.update();let t=this.velocity.multiply(v.deltaTime);this.move(t.x,t.y)}move(t,e){let i,o;t instanceof y?(i=t.x,o=t.y):(i=t,o=e);let r=Math.max(Math.abs(i),Math.abs(o)),n=Math.max(1,Math.ceil(r/.25)),a=i/n,h=o/n,c=new Set,d=!1,u=new y(0,0);for(let f=0;f<n;f++){let g=this.gameObject.position.clone();if(this._doMove(a,h),u=u.add(new y(a,h)),this.#t)for(let x of w.instance.colliders){if(x===this.#t||!this.#t.checkCollisionWith(x))continue;let S=x.gameObject;c.add(S);let z=this.#o.has(S),N=this.#t.isTrigger()||x.isTrigger();if(z?(this.#r(this.gameObject,S),S.hasComponent?.(s)||this.#r(S,this.gameObject)):(this.#s(this.gameObject,S),S.hasComponent?.(s)||this.#s(S,this.gameObject)),!N&&!d){this.gameObject.setPosition(g),Math.abs(h)>Math.abs(a)?this.velocity.y*=-this.bounciness:this.velocity.x*=-this.bounciness,d=!0;break}}if(d)break;this.#i(c),this.#o=c}return!0}#i(t){for(let e of this.#o)if(!t.has(e)){let i=e.getComponent(b);i?this.#n(i,2.5)?t.add(e):(this.#e(this.gameObject,e),e?.hasComponent?.(s)||this.#e(e,this.gameObject)):(this.#e(this.gameObject,e),e?.hasComponent?.(s)||this.#e(e,this.gameObject))}}#n(t,e=2){let i=this.#t.getBounds(),o=t.getBounds();return i.x<o.x+o.width+e&&i.x+i.width+e>o.x&&i.y<o.y+o.height+e&&i.y+i.height+e>o.y}#s(t,e){t?.getComponent?.(b)?.isTrigger()?t?.onTriggerEnter?.(e):t?.onCollisionEnter?.(e)}#r(t,e){t?.getComponent?.(b)?.isTrigger()?t?.onTriggerStay?.(e):t?.onCollisionStay?.(e)}#e(t,e){t?.getComponent?.(b)?.isTrigger()?t?.onTriggerExit?.(e):t?.onCollisionExit?.(e)}_doMove(t,e){t instanceof y?this.gameObject.translate(t):this.gameObject.translate(t,e)}};var st=class extends p{static{l(this,"MovementComponent")}rigidbody;constructor(t=100){super(),this.speed=t}start(){this.rigidbody=this.gameObject.getComponent(Z),this.rigidbody||console.warn("MovementComponent requires RigidbodyComponent to function properly.")}update(){let t=new y(0,0);(M.isKeyDown("ArrowRight")||M.isKeyDown("d")||M.isKeyDown("D"))&&(t.x+=this.speed*v.deltaTime),(M.isKeyDown("ArrowLeft")||M.isKeyDown("a")||M.isKeyDown("A"))&&(t.x-=this.speed*v.deltaTime),(M.isKeyDown("ArrowDown")||M.isKeyDown("s")||M.isKeyDown("S"))&&(t.y+=this.speed*v.deltaTime),(M.isKeyDown("ArrowUp")||M.isKeyDown("w")||M.isKeyDown("W"))&&(t.y-=this.speed*v.deltaTime),t.magnitude>0&&this.rigidbody.move(t)}},dt=class extends st{static{l(this,"MovementController")}};var ut=class s{static{l(this,"SpriteAsset")}constructor(t,e,i={}){if(t.includes(":"))throw new Error(`SpriteAsset name "${t}" cannot contain colons. Colons are reserved for spritesheet sprite notation (e.g., "sheet:sprite").`);this.name=t,this.imagePath=e,this.image=null,this.isLoaded=!1,this.width=i.width||null,this.height=i.height||null,this.pivotX=i.pivotX||.5,this.pivotY=i.pivotY||.5,this.#t(),this.load()}#t(){C._addSprite(this.name,this)}load(){return new Promise((t,e)=>{this.image=new Image,this.image.onload=()=>{this.isLoaded=!0,this.width||(this.width=this.image.width),this.height||(this.height=this.image.height),t(this)},this.image.onerror=e,this.image.src=this.imagePath})}draw(t,e,i,o,r,n=0,a=1,h=1){if(!this.isLoaded)return;let c=o||this.width,d=r||this.height;t.save(),t.translate(e,i),n!==0&&t.rotate(n),t.scale(a,h);let u=-c*this.pivotX,f=-d*this.pivotY;t.drawImage(this.image,u,f,c,d),t.restore()}getBounds(t,e,i,o){let r=i||this.width,n=o||this.height;return{x:t-r*this.pivotX,y:e-n*this.pivotY,width:r,height:n}}clone(t={}){let e={width:this.width,height:this.height,pivotX:this.pivotX,pivotY:this.pivotY,...t};return new s(this.imagePath,e)}};var pt=class{static{l(this,"SpritesheetAsset")}constructor(t,e,i){if(t.includes(":"))throw new Error(`SpritesheetAsset name "${t}" cannot contain colons. Colons are reserved for sprite notation within sheets.`);this.name=t,this.imagePath=e,this.spriteData=i,this.image=null,this.isLoaded=!1,this.sprites=new Map,this.generateSprites(),this._registerSelf(),this.load()}_registerSelf(){C._addSpritesheet(this.name,this),this._registerIndividualSprites()}load(){return new Promise((t,e)=>{this.image=new Image,this.image.onload=()=>{this.isLoaded=!0,this._updateSpriteWrappers(),t(this)},this.image.onerror=e,this.image.src=this.imagePath})}generateSprites(){let{spriteWidth:t,spriteHeight:e,columns:i,rows:o,sprites:r,namedSprites:n}=this.spriteData;if(i!=null&&o!=null&&t!=null&&e!=null)for(let a=0;a<o;a++)for(let h=0;h<i;h++){let d=`sprite_${a*i+h}`,u={x:h*t,y:a*e,width:t,height:e};this.sprites.set(d,u)}r!=null&&Array.isArray(r)&&r.forEach(a=>{if(a.name&&a.startX!=null&&a.startY!=null&&a.endX!=null&&a.endY!=null){let h={x:a.startX,y:a.startY,width:a.endX-a.startX,height:a.endY-a.startY};this.sprites.set(a.name,h)}else console.warn(`Invalid sprite definition in "${this.name}":`,a)}),n!=null&&typeof n=="object"&&!Array.isArray(n)&&Object.entries(n).forEach(([a,h])=>{this.sprites.set(a,h)})}_updateSpriteWrappers(){for(let t of this.sprites.keys()){let e=`${this.name}:${t}`,i=C.getSprite(e);i&&(i.image=this.image,i.isLoaded=this.isLoaded)}}_registerIndividualSprites(){for(let t of this.sprites.keys()){let e=`${this.name}:${t}`;C._addSprite(e,this._createSpriteWrapper(t))}}_createSpriteWrapper(t){let e=this.sprites.get(t);return e?{name:`${this.name}:${t}`,image:this.image,isLoaded:this.isLoaded,width:e.width,height:e.height,pivotX:.5,pivotY:.5,sourceX:e.x,sourceY:e.y,sourceWidth:e.width,sourceHeight:e.height,draw:l((i,o,r,n,a,h=0,c=1,d=1)=>{if(!this.isLoaded||!this.image)return;let u=n||e.width,f=a||e.height;i.save(),i.translate(o,r),h!==0&&i.rotate(h),i.scale(c,d);let g=-u*.5,x=-f*.5;i.drawImage(this.image,e.x,e.y,e.width,e.height,g,x,u,f),i.restore()},"draw"),getBounds:l((i,o,r,n)=>{let a=r||e.width,h=n||e.height;return{x:i-a*.5,y:o-h*.5,width:a,height:h}},"getBounds")}:null}getSprite(t){return this.sprites.get(t)||null}getSpriteNames(){return Array.from(this.sprites.keys())}drawSprite(t,e,i,o,r,n){if(!this.isLoaded)return;let a=this.getSprite(e);if(!a)return;let h=r||a.width,c=n||a.height;t.drawImage(this.image,a.x,a.y,a.width,a.height,i,o,h,c)}};var mt=class extends p{static{l(this,"ImageComponent")}constructor(t,e=null,i=null){super(),this.src=t,this.image=null,this.width=e,this.height=i}static getDefaultMeta(){return{src:"",width:null,height:null}}_applyConstructorArgs(t,e=null,i=null){let o={src:t||"",width:e,height:i};this.applyMeta(o)}_updatePropertiesFromMeta(){this.src=this.__meta.src,this.width=this.__meta.width,this.height=this.__meta.height,this.image&&this.image.src!==this.src&&(this.image=null)}_validateMeta(){let t=this.__meta;if(typeof t.src!="string")throw new Error("src must be a string");if(t.width!==null&&(typeof t.width!="number"||t.width<=0))throw new Error("width must be null or a positive number");if(t.height!==null&&(typeof t.height!="number"||t.height<=0))throw new Error("height must be null or a positive number")}async preload(){return new Promise(t=>{let e=new Image;e.src=this.src,e.onload=()=>{this.image=e,this.width===null&&(this.width=e.width),this.height===null&&(this.height=e.height),t()}})}draw(t){if(this.image){let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),i!==0&&t.rotate(i),t.drawImage(this.image,-this.width/2,-this.height/2,this.width,this.height),t.restore()}}__internalGizmos(t){if(!this.image)return;let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),i!==0&&t.rotate(i),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center";let o=this.src.split("/").pop();t.fillText(o,0,-this.height/2-8),t.fillText(`${this.width}x${this.height}`,0,this.height/2+15),t.restore()}};var ft=class extends p{static{l(this,"ShapeComponent")}constructor(t,e={radius:10,width:10,height:10,color:"white"}){super(),this.__meta=this.constructor.getDefaultMeta(),t||Object.keys(e).length>0?this._applyConstructorArgs(t,e):this._updatePropertiesFromMeta()}static getDefaultMeta(){return{shape:"rectangle",options:{width:10,height:10,color:"white",radius:10,radiusX:10,radiusY:5,x2:10,y2:0,size:20,points:[]}}}_applyConstructorArgs(t,e={}){let i={shape:t||"rectangle",options:{...this.__meta.options,...e}};this.applyMeta(i)}_updatePropertiesFromMeta(){this.shape=this.__meta.shape,this.options={...this.__meta.options}}_validateMeta(){let t=["rectangle","square","circle","ellipse","line","triangle","polygon"];if(!t.includes(this.__meta.shape))throw new Error(`ShapeComponent: Invalid shape type "${this.__meta.shape}". Valid types: ${t.join(", ")}`);if(typeof this.__meta.options.color!="string")throw new Error("ShapeComponent: options.color must be a string");if(["rectangle","square"].includes(this.__meta.shape)&&(this.__meta.options.width<=0||this.__meta.options.height<=0))throw new Error("ShapeComponent: width and height must be greater than 0 for rectangles");if(this.__meta.shape==="circle"&&this.__meta.options.radius<=0)throw new Error("ShapeComponent: radius must be greater than 0 for circles")}get color(){return this.options.color||"black"}set color(t){this.options.color=t}get width(){return this.options.width||10}set width(t){this.options.width=t}get height(){return this.options.height||10}set height(t){this.options.height=t}get radius(){return this.options.radius||10}set radius(t){this.options.radius=t}get radiusX(){return this.options.radiusX||10}set radiusX(t){this.options.radiusX=t}get radiusY(){return this.options.radiusY||5}set radiusY(t){this.options.radiusY=t}get points(){return this.options.points||[]}set points(t){this.options.points=t}get x2(){return this.options.x2||10}set x2(t){this.options.x2=t}get y2(){return this.options.y2||0}set y2(t){this.options.y2=t}get size(){return this.options.size||20}set size(t){this.options.size=t}__draw(t){let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation();t.save(),i!==0?(t.translate(e.x,e.y),t.rotate(i),this.drawShape(t,0,0)):this.drawShape(t,e.x,e.y),t.restore()}drawShape(t,e,i){switch(this.shape){case"rectangle":case"square":this.drawRect(t,e,i);break;case"circle":this.drawCircle(t,e,i);break;case"ellipse":this.drawEllipse(t,e,i);break;case"line":this.drawLine(t,e,i);break;case"triangle":this.drawTriangle(t,e,i);break;case"polygon":this.drawPolygon(t,e,i);break;default:throw new Error(`ShapeComponent: Unsupported shape type "${this.shape}"`)}}drawRect(t,e,i){let{width:o=10,height:r=10,color:n="black"}=this.options;t.fillStyle=n,t.fillRect(e-o/2,i-r/2,o,r)}drawCircle(t,e,i){let{radius:o=10,color:r="black"}=this.options;t.beginPath(),t.arc(e,i,o,0,Math.PI*2),t.fillStyle=r,t.fill()}drawEllipse(t,e,i){let{radiusX:o=10,radiusY:r=5,color:n="black"}=this.options;t.beginPath(),t.ellipse(e,i,o,r,0,0,Math.PI*2),t.fillStyle=n,t.fill()}drawLine(t,e,i){let{x2:o=e+10,y2:r=i,color:n="black",width:a=2}=this.options;t.strokeStyle=n,t.lineWidth=a,t.beginPath(),t.moveTo(e,i),t.lineTo(o,r),t.stroke()}drawTriangle(t,e,i){let{size:o=20,color:r="black"}=this.options;t.fillStyle=r,t.beginPath(),t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o/2,i-o),t.closePath(),t.fill()}drawPolygon(t,e,i){let{points:o=[],color:r="black"}=this.options;if(!(o.length<3)){t.fillStyle=r,t.beginPath(),t.moveTo(e+o[0][0],i+o[0][1]);for(let n=1;n<o.length;n++)t.lineTo(e+o[n][0],i+o[n][1]);t.closePath(),t.fill()}}__internalGizmos(t){if(!this.gameObject)return;let e=this.gameObject.getGlobalPosition(),i=this.gameObject.getGlobalRotation();t.save(),t.translate(e.x,e.y),i!==0&&t.rotate(i),t.strokeStyle="#FF00FF",t.lineWidth=1,t.setLineDash([4,2]);let{shape:o,size:r=10,width:n=10,height:a=10}=this.options;switch(o){case"rectangle":t.strokeRect(-n/2,-a/2,n,a);break;case"circle":t.beginPath(),t.arc(0,0,r,0,2*Math.PI),t.stroke();break;case"triangle":let c=r;t.beginPath(),t.moveTo(0,-c/2),t.lineTo(-r/2,c/2),t.lineTo(r/2,c/2),t.closePath(),t.stroke();break;case"polygon":let{points:d=[]}=this.options;if(d.length>=3){t.beginPath(),t.moveTo(d[0][0],d[0][1]);for(let u=1;u<d.length;u++)t.lineTo(d[u][0],d[u][1]);t.closePath(),t.stroke()}break}t.setLineDash([]),t.fillStyle="#FF00FF",t.beginPath(),t.arc(0,0,2,0,2*Math.PI),t.fill(),t.fillStyle="#FF00FF",t.font="10px Arial",t.textAlign="center",t.fillText(`Shape: ${o||"none"}`,0,-Math.max(r,a)/2-8);let h="";switch(o){case"rectangle":h=`${n}x${a}`;break;case"circle":h=`r:${r}`;break;case"triangle":h=`s:${r}`;break;case"polygon":h=`${this.options.points?.length||0} pts`;break}h&&t.fillText(h,0,Math.max(r,a)/2+15),t.restore()}};U();W();var gt=class extends p{static{l(this,"TilemapComponent")}constructor(t={}){super(),this.tileSize=t.tileSize||32,this.tileWidth=t.tileWidth||this.tileSize,this.tileHeight=t.tileHeight||this.tileSize,this.tiles=t.tiles||{},this.grid=t.grid||[],this.zIndex=t.zIndex||0,this.sortingLayer=t.sortingLayer||"Default",this.enableCollision=t.enableCollision!==!1,this.resolvedTiles=new Map,this.resolvedSprites=new Map,this.colliders=[],this.gridWidth=this.grid.length>0?this.grid[0].length:0,this.gridHeight=this.grid.length}start(){this.resolveTiles(),this.createColliders()}resolveTiles(){this.resolvedTiles.clear(),this.resolvedSprites.clear();for(let[t,e]of Object.entries(this.tiles)){if(e==null){this.resolvedTiles.set(t,null);continue}let i=null;if(typeof e=="string"){if(i=I.getTile(e),!i){console.warn(`TilemapComponent: Tile "${e}" not found in TileRegistry`);continue}}else if(e instanceof $)i=e;else{console.warn(`TilemapComponent: Invalid tile reference for id "${t}":`,e);continue}this.resolvedTiles.set(t,i);let o=C.getSprite(i.spriteName);o?this.resolvedSprites.set(t,o):console.warn(`TilemapComponent: Sprite "${i.spriteName}" not found for tile "${i.name}"`)}}createColliders(){if(this.enableCollision){this.clearColliders();for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++){let i=this.grid[t][e],o=this.resolvedTiles.get(String(i));o&&o.hasCollision()&&this.createTileCollider(o,e,t)}}}createTileCollider(t,e,i){let o=this.gameObject.x+e*this.tileWidth,r=this.gameObject.y+i*this.tileHeight,n={x:o,y:r,width:t.collider.width||this.tileWidth,height:t.collider.height||this.tileHeight,radius:t.collider.radius,type:t.collider.type||"box",trigger:t.collider.trigger||!1,tile:t,gridX:e,gridY:i};this.colliders.push(n)}clearColliders(){this.colliders=[]}__draw(t){t.save(),t.translate(this.gameObject.x,this.gameObject.y);for(let e=0;e<this.grid.length;e++)for(let i=0;i<this.grid[e].length;i++)this.renderTile(t,i,e);t.restore()}draw(t){}renderTile(t,e,i){let o=this.grid[i][e],r=this.resolvedTiles.get(String(o)),n=this.resolvedSprites.get(String(o));if(!r||!n)return;let a=e*this.tileWidth,h=i*this.tileHeight;t.save(),r.opacity!==1&&(t.globalAlpha=r.opacity),r.color!=="#FFFFFF"&&(t.fillStyle=r.color,t.globalCompositeOperation="multiply"),r.flipX||r.flipY?(t.translate(a+this.tileWidth/2,h+this.tileHeight/2),t.scale(r.flipX?-1:1,r.flipY?-1:1),t.translate(-this.tileWidth/2,-this.tileHeight/2)):t.translate(a,h);let c=r.width||this.tileWidth,d=r.height||this.tileHeight;n.image&&n.image.complete&&n.draw(t,c/2,d/2,c,d,0),t.restore()}getTileAt(t,e){if(e<0||e>=this.grid.length||t<0||t>=this.grid[e].length)return null;let i=this.grid[e][t];return this.resolvedTiles.get(String(i))||null}setTileAt(t,e,i){e<0||e>=this.grid.length||t<0||t>=this.grid[e].length||(this.grid[e][t]=i,this.enableCollision&&this.createColliders())}worldToGrid(t,e){let i=t-this.gameObject.x,o=e-this.gameObject.y;return{col:Math.floor(i/this.tileWidth),row:Math.floor(o/this.tileHeight)}}gridToWorld(t,e){return{x:this.gameObject.x+t*this.tileWidth,y:this.gameObject.y+e*this.tileHeight}}getTilesWhere(t){let e=[];for(let i=0;i<this.grid.length;i++)for(let o=0;o<this.grid[i].length;o++){let r=this.getTileAt(o,i);r&&t(r,o,i)&&e.push({tile:r,col:o,row:i})}return e}update(t){}destroy(){this.clearColliders(),this.resolvedTiles.clear(),this.resolvedSprites.clear(),super.destroy()}};var V=class s extends b{static{l(this,"CircleColliderComponent")}constructor(t=null,e=!1){super(),this.radius=t,this.trigger=e}static getDefaultMeta(){return{radius:null,trigger:!1}}_applyConstructorArgs(t=null,e=!1){let i={radius:t,trigger:e};this.applyMeta(i)}_updatePropertiesFromMeta(){this.radius=this.__meta.radius,this.trigger=this.__meta.trigger}_validateMeta(){let t=this.__meta;if(t.radius!==null&&(typeof t.radius!="number"||t.radius<=0))throw new Error("radius must be null or a positive number");if(typeof t.trigger!="boolean")throw new Error("trigger must be a boolean")}checkCollisionWith(t){if(t instanceof s){let e=this.getBounds(),i=t.getBounds(),o=e.x-i.x,r=e.y-i.y;return Math.hypot(o,r)<e.radius+i.radius}else return this.circleBoxCollision(t)}circleBoxCollision(t){let e=this.getBounds(),i=t.getBounds(),o=Math.max(i.x,Math.min(e.x,i.x+i.width)),r=Math.max(i.y,Math.min(e.y,i.y+i.height)),n=e.x-o,a=e.y-r;return n*n+a*a<e.radius*e.radius}getBounds(){let t=this.gameObject.getGlobalPosition(),e=this.radius;return{x:t.x,y:t.y,radius:e}}__internalGizmos(t){let e=this.getBounds();t.save(),t.strokeStyle=this.trigger?"#00ffddff":"#00FF00",t.lineWidth=1,t.setLineDash([2,2]),t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2),t.stroke();let i=3;t.setLineDash([]),t.beginPath(),t.moveTo(e.x-i,e.y),t.lineTo(e.x+i,e.y),t.moveTo(e.x,e.y-i),t.lineTo(e.x,e.y+i),t.stroke(),t.restore()}};var yt=class s extends b{static{l(this,"BoxColliderComponent")}constructor(t=null,e=null,i=!1){super(),this.width=t,this.height=e,this.trigger=i}static getDefaultMeta(){return{width:null,height:null,trigger:!1}}_applyConstructorArgs(t=null,e=null,i=!1){let o={width:t,height:e,trigger:i};this.applyMeta(o)}_updatePropertiesFromMeta(){this.width=this.__meta.width,this.height=this.__meta.height,this.trigger=this.__meta.trigger}_validateMeta(){let t=this.__meta;if(t.width!==null&&(typeof t.width!="number"||t.width<=0))throw new Error("width must be null or a positive number");if(t.height!==null&&(typeof t.height!="number"||t.height<=0))throw new Error("height must be null or a positive number");if(typeof t.trigger!="boolean")throw new Error("trigger must be a boolean")}checkCollisionWith(t){return t instanceof s?this.checkBoxBoxCollision(t):t instanceof V?t.checkCollisionWith(this):!1}checkBoxBoxCollision(t){let e=this.getBounds(),i=t.getBounds(),o=.01;return e.x<i.x+i.width+o&&e.x+e.width+o>i.x&&e.y<i.y+i.height+o&&e.y+e.height+o>i.y}getBounds(){let t=this.gameObject.getGlobalPosition(),e=this.width,i=this.height;return{x:t.x-e/2,y:t.y-i/2,width:e,height:i}}__internalGizmos(t){let e=this.getBounds();t.save(),t.strokeStyle=this.trigger?"#00ffddff":"#00FF00",t.lineWidth=1,t.setLineDash([2,2]),t.strokeRect(e.x,e.y,e.width,e.height);let i=e.x+e.width/2,o=e.y+e.height/2,r=3;t.setLineDash([]),t.beginPath(),t.moveTo(i-r,o),t.lineTo(i+r,o),t.moveTo(i,o-r),t.lineTo(i,o+r),t.stroke(),t.restore()}};var wt=class{static{l(this,"Random")}static range(t,e){return Math.floor(Math.random()*(e-t+1)+t)}};var Mt=class s{static{l(this,"Vector3")}constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}static get zero(){return new s(0,0,0)}static get one(){return new s(1,1,1)}static get up(){return new s(0,1,0)}static get down(){return new s(0,-1,0)}static get left(){return new s(-1,0,0)}static get right(){return new s(1,0,0)}static get forward(){return new s(0,0,1)}static get back(){return new s(0,0,-1)}static get positiveInfinity(){return new s(1/0,1/0,1/0)}static get negativeInfinity(){return new s(-1/0,-1/0,-1/0)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}get sqrMagnitude(){return this.x*this.x+this.y*this.y+this.z*this.z}get normalized(){let t=this.magnitude;return t===0?s.zero:new s(this.x/t,this.y/t,this.z/t)}add(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z)}subtract(t){return new s(this.x-t.x,this.y-t.y,this.z-t.z)}multiply(t){return new s(this.x*t,this.y*t,this.z*t)}divide(t){if(t===0)throw new Error("Cannot divide by zero");return new s(this.x/t,this.y/t,this.z/t)}normalize(){let t=this.magnitude;return t===0?(this.x=0,this.y=0,this.z=0):(this.x/=t,this.y/=t,this.z/=t),this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}clone(){return new s(this.x,this.y,this.z)}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}toString(){return`(${this.x.toFixed(2)}, ${this.y.toFixed(2)}, ${this.z.toFixed(2)})`}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){return new s(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static distance(t,e){let i=t.x-e.x,o=t.y-e.y,r=t.z-e.z;return Math.sqrt(i*i+o*o+r*r)}static sqrDistance(t,e){let i=t.x-e.x,o=t.y-e.y,r=t.z-e.z;return i*i+o*o+r*r}static lerp(t,e,i){return i=Math.max(0,Math.min(1,i)),new s(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i,t.z+(e.z-t.z)*i)}static lerpUnclamped(t,e,i){return new s(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i,t.z+(e.z-t.z)*i)}static slerp(t,e,i){i=Math.max(0,Math.min(1,i));let o=s.dot(t.normalized,e.normalized),r=Math.max(-1,Math.min(1,o));if(Math.abs(r)>.9995)return s.lerp(t,e,i);let n=Math.acos(Math.abs(r)),a=Math.sin(n),h=Math.sin((1-i)*n)/a,c=Math.sin(i*n)/a;return r<0?new s(h*t.x-c*e.x,h*t.y-c*e.y,h*t.z-c*e.z):new s(h*t.x+c*e.x,h*t.y+c*e.y,h*t.z+c*e.z)}static min(t,e){return new s(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))}static max(t,e){return new s(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))}static moveTowards(t,e,i){let o=e.subtract(t),r=o.magnitude;return r<=i||r===0?e.clone():t.add(o.divide(r).multiply(i))}static reflect(t,e){let i=-2*s.dot(e,t);return new s(i*e.x+t.x,i*e.y+t.y,i*e.z+t.z)}static angle(t,e){let i=Math.sqrt(t.sqrMagnitude*e.sqrMagnitude);if(i<1e-15)return 0;let o=Math.max(-1,Math.min(1,s.dot(t,e)/i));return Math.acos(o)}static project(t,e){let i=e.sqrMagnitude;if(i<1e-15)return s.zero;let o=s.dot(t,e);return e.multiply(o/i)}static projectOnPlane(t,e){let i=e.sqrMagnitude;if(i<1e-15)return t.clone();let o=s.dot(t,e);return t.subtract(e.multiply(o/i))}static clampMagnitude(t,e){let i=t.sqrMagnitude;if(i>e*e){let o=Math.sqrt(i),r=t.x/o,n=t.y/o,a=t.z/o;return new s(r*e,n*e,a*e)}return t.clone()}static rotateTowards(t,e,i,o){let r=t.magnitude,n=e.magnitude;if(r>1e-15&&n>1e-15){let h=t.divide(r),c=e.divide(n),d=s.angle(h,c);if(d>1e-15){let u=Math.min(1,i/d),f=s.slerp(h,c,u),g=r+Math.max(-o,Math.min(o,n-r));return f.multiply(g)}}let a=r+Math.max(-o,Math.min(o,n-r));return e.normalized.multiply(a)}static smoothDamp(t,e,i,o,r=1/0,n){o=Math.max(1e-4,o);let a=2/o,h=a*n,c=1/(1+h+.48*h*h+.235*h*h*h),d=t.x-e.x,u=t.y-e.y,f=t.z-e.z,g=e.clone(),x=r*o,S=x*x,z=d*d+u*u+f*f;if(z>S){let J=Math.sqrt(z);d=d/J*x,u=u/J*x,f=f/J*x}let N=t.x-d,q=t.y-u,R=t.z-f,L=(i.x+a*d)*n,D=(i.y+a*u)*n,X=(i.z+a*f)*n;i.x=(i.x-a*L)*c,i.y=(i.y-a*D)*c,i.z=(i.z-a*X)*c;let E=N+(d+L)*c,k=q+(u+D)*c,A=R+(f+X)*c,Y=g.x-t.x,xt=g.y-t.y,St=g.z-t.z,Tt=E-g.x,Ft=k-g.y,_t=A-g.z;return Y*Tt+xt*Ft+St*_t>0&&(E=g.x,k=g.y,A=g.z,i.x=(E-g.x)/n,i.y=(k-g.y)/n,i.z=(A-g.z)/n),new s(E,k,A)}static orthonormalize(t){let e=t.normalized,i;Math.abs(e.x)<.9?i=s.cross(e,s.right).normalized:i=s.cross(e,s.up).normalized;let o=s.cross(e,i).normalized;return{normal:e,tangent:i,binormal:o}}};var bt=class extends p{static{l(this,"FollowTarget")}constructor(t){super(),this.target=t}update(){this.target&&(this.target instanceof y?this.gameObject.setPosition(this.target):this.target.position?this.gameObject.setPosition(this.target.position):this.gameObject.setPosition(this.target.x,this.target.y))}};var ot=class s{static{l(this,"AudioClip")}constructor(t,e){this.name=t,this.url=e,this.audioBuffer=null,this.length=0,this.channels=0,this.frequency=0,this.isLoaded=!1,this.isLoading=!1,this.loadError=null,this.audioContext=s.getAudioContext()}static getAudioContext(){if(!s._audioContext){let t=window.AudioContext||window.webkitAudioContext;if(!t)throw new Error("Web Audio API not supported in this browser");s._audioContext=new t,s._audioContext.state==="suspended"&&document.addEventListener("click",()=>{s._audioContext.state==="suspended"&&s._audioContext.resume()},{once:!0})}return s._audioContext}async load(){if(this.isLoaded)return!0;if(this.isLoading)return new Promise(t=>{let e=l(()=>{this.isLoading?setTimeout(e,10):t(this.isLoaded)},"checkLoaded");e()});this.isLoading=!0,this.loadError=null;try{let t=await fetch(this.url);if(!t.ok)throw new Error(`Failed to fetch audio: ${t.status} ${t.statusText}`);let e=await t.arrayBuffer();return this.audioBuffer=await this.audioContext.decodeAudioData(e),this.length=this.audioBuffer.length/this.audioBuffer.sampleRate,this.channels=this.audioBuffer.numberOfChannels,this.frequency=this.audioBuffer.sampleRate,this.isLoaded=!0,this.isLoading=!1,console.log(`\u2705 Audio clip loaded: ${this.name} (${this.length.toFixed(2)}s, ${this.channels}ch, ${this.frequency}Hz)`),!0}catch(t){return this.loadError=t.message,this.isLoading=!1,this.isLoaded=!1,console.error(`\u274C Failed to load audio clip '${this.name}':`,t),!1}}createSourceNode(){if(!this.isLoaded||!this.audioBuffer)return console.warn(`Cannot create source node: Audio clip '${this.name}' not loaded`),null;let t=this.audioContext.createBufferSource();return t.buffer=this.audioBuffer,t}get isReady(){return this.isLoaded&&this.audioBuffer!==null}get state(){return this.loadError?"error":this.isLoading?"loading":this.isLoaded?"loaded":"unloaded"}static async preloadAll(t){let e=t.map(i=>i.load());return Promise.all(e)}};ot._audioContext=null;var _=class s extends p{static{l(this,"AudioListenerComponent")}constructor(){super(),this.masterVolume=1,this.dopplerFactor=1,this.rolloffFactor=1,this.isActive=!1,s.main||this.setAsMainListener(),console.log(`\u{1F3A7} AudioListener created ${this.isActive?"(ACTIVE)":"(inactive)"}`)}setAsMainListener(){s.main&&s.main!==this&&(s.main.isActive=!1,console.log("\u{1F3A7} Previous AudioListener deactivated")),s.main=this,this.isActive=!0,console.log("\u{1F3A7} AudioListener activated as main listener")}calculate3DAudio(t,e=500,i="linear"){if(!this.isActive||!this.gameObject)return{volume:0,pan:0,distance:1/0};let o=this.gameObject.position,r=t.x-o.x,n=t.y-o.y,a=Math.sqrt(r*r+n*n),h=1;if(a>0&&e>0)switch(i){case"linear":h=Math.max(0,1-a/e);break;case"logarithmic":h=Math.max(0,1/(1+a/e));break;case"inverse":h=Math.max(0,e/(e+a));break;default:h=Math.max(0,1-a/e)}h*=this.rolloffFactor*this.masterVolume;let c=0;if(a>0){let d=e*.5;c=Math.max(-1,Math.min(1,r/d))}return{volume:Math.max(0,Math.min(1,h)),pan:Math.max(-1,Math.min(1,c)),distance:a}}setMasterVolume(t){this.masterVolume=Math.max(0,Math.min(1,t)),console.log(`\u{1F50A} Master volume set to ${(this.masterVolume*100).toFixed(0)}%`)}get position(){return this.gameObject?this.gameObject.position:null}destroy(){s.main===this&&(s.main=null,console.log("\u{1F3A7} Main AudioListener removed")),super.destroy()}static getDefaultMeta(){return{masterVolume:1,dopplerFactor:1,rolloffFactor:1}}_updatePropertiesFromMeta(){this.masterVolume=this.__meta.masterVolume,this.dopplerFactor=this.__meta.dopplerFactor,this.rolloffFactor=this.__meta.rolloffFactor}_validateMeta(){if(typeof this.__meta.masterVolume!="number"||this.__meta.masterVolume<0||this.__meta.masterVolume>1)throw new Error("AudioListener masterVolume must be a number between 0 and 1");if(typeof this.__meta.dopplerFactor!="number"||this.__meta.dopplerFactor<0)throw new Error("AudioListener dopplerFactor must be a non-negative number");if(typeof this.__meta.rolloffFactor!="number"||this.__meta.rolloffFactor<0)throw new Error("AudioListener rolloffFactor must be a non-negative number")}};_.main=null;var vt=class extends p{static{l(this,"AudioSourceComponent")}constructor(t=null,e={}){super(),this.__meta=this.constructor.getDefaultMeta(),t||Object.keys(e).length>0?this._applyConstructorArgs(t,e):this._updatePropertiesFromMeta(),this.isPlaying=!1,this.isPaused=!1,this.currentTime=0,this.sourceNode=null,this.gainNode=null,this.pannerNode=null,this.audioContext=null,this.startTime=0,this.pauseTime=0,console.log(`\u{1F50A} AudioSource created (${this.spatial?"3D":"2D"} audio)`)}static getDefaultMeta(){return{clip:null,spatial:!0,autoPlay:!1,loop:!1,volume:1,pitch:1,maxDistance:500,minDistance:1,rolloffMode:"linear"}}_applyConstructorArgs(t,e={}){let i={...this.__meta,clip:t,...e};this.applyMeta(i)}_updatePropertiesFromMeta(){this.clip=this.__meta.clip,this.spatial=this.__meta.spatial,this.autoPlay=this.__meta.autoPlay,this.loop=this.__meta.loop,this.volume=this.__meta.volume,this.pitch=this.__meta.pitch,this.maxDistance=this.__meta.maxDistance,this.minDistance=this.__meta.minDistance,this.rolloffMode=this.__meta.rolloffMode,this.autoPlay&&this.clip&&this.clip.isReady&&this.play()}_validateMeta(){if(this.__meta.volume<0||this.__meta.volume>1)throw new Error("AudioSource volume must be between 0 and 1");if(this.__meta.pitch<.1||this.__meta.pitch>3)throw new Error("AudioSource pitch must be between 0.1 and 3");if(this.__meta.maxDistance<=0)throw new Error("AudioSource maxDistance must be positive");let t=["linear","logarithmic","inverse"];if(!t.includes(this.__meta.rolloffMode))throw new Error(`AudioSource rolloffMode must be one of: ${t.join(", ")}`)}play(t=0){if(!this.clip||!this.clip.isReady)return console.warn("Cannot play: AudioClip not loaded or not assigned"),!1;this.stop();try{if(this.audioContext=this.clip.audioContext,this.sourceNode=this.clip.createSourceNode(),!this.sourceNode)return console.error("Failed to create audio source node"),!1;this.sourceNode.loop=this.loop,this.sourceNode.playbackRate.value=this.pitch,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.sourceNode.connect(this.gainNode),this.spatial&&this.gameObject?this._setup3DAudio():this.gainNode.connect(this.audioContext.destination),this.sourceNode.onended=()=>{this.loop||(this.isPlaying=!1,this.currentTime=0,this._cleanup())};let e=this.audioContext.currentTime+t,i=this.isPaused?this.pauseTime:0;return this.sourceNode.start(e,i),this.isPlaying=!0,this.isPaused=!1,this.startTime=e-i,console.log(`\u{1F3B5} Audio started: ${this.clip.name} (${this.spatial?"3D":"2D"})`),!0}catch(e){return console.error("Failed to play audio:",e),this._cleanup(),!1}}pause(){if(this.isPlaying){if(this.pauseTime=this.audioContext.currentTime-this.startTime,this.sourceNode)try{this.sourceNode.stop()}catch{}this.isPlaying=!1,this.isPaused=!0,this._cleanup(),console.log(`\u23F8\uFE0F Audio paused: ${this.clip?this.clip.name:"unknown"}`)}}stop(){if(!(!this.isPlaying&&!this.isPaused)){if(this.sourceNode)try{this.sourceNode.stop()}catch{}this.isPlaying=!1,this.isPaused=!1,this.currentTime=0,this.pauseTime=0,this._cleanup(),console.log(`\u23F9\uFE0F Audio stopped: ${this.clip?this.clip.name:"unknown"}`)}}_setup3DAudio(){if(!this.spatial||!this.gameObject||!_.main){this.gainNode.connect(this.audioContext.destination);return}let e=_.main.calculate3DAudio(this.gameObject.position,this.maxDistance,this.rolloffMode);this.pannerNode=this.audioContext.createStereoPanner(),this.pannerNode.pan.value=e.pan,this.gainNode.gain.value=this.volume*e.volume,this.gainNode.connect(this.pannerNode),this.pannerNode.connect(this.audioContext.destination),console.log(`\u{1F3AF} 3D Audio: vol=${e.volume.toFixed(2)}, pan=${e.pan.toFixed(2)}, dist=${e.distance.toFixed(1)}`)}update(){if(this.isPlaying&&this.spatial&&this.pannerNode&&this.gameObject&&_.main){let e=_.main.calculate3DAudio(this.gameObject.position,this.maxDistance,this.rolloffMode);this.gainNode.gain.value=this.volume*e.volume,this.pannerNode.pan.value=e.pan}this.isPlaying&&this.audioContext&&(this.currentTime=this.audioContext.currentTime-this.startTime)}_cleanup(){this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),this.pannerNode&&(this.pannerNode.disconnect(),this.pannerNode=null)}setVolume(t){if(this.volume=Math.max(0,Math.min(1,t)),this.gainNode)if(this.spatial&&this.gameObject&&_.main){let i=_.main.calculate3DAudio(this.gameObject.position,this.maxDistance,this.rolloffMode);this.gainNode.gain.value=this.volume*i.volume}else this.gainNode.gain.value=this.volume}setPitch(t){this.pitch=Math.max(.1,Math.min(3,t)),this.sourceNode&&(this.sourceNode.playbackRate.value=this.pitch)}get time(){return this.currentTime}set time(t){if(this.clip&&t>=0&&t<=this.clip.length){let e=this.isPlaying;this.stop(),this.pauseTime=t,this.isPaused=!0,e&&this.play()}}destroy(){this.stop(),super.destroy()}};var T=class s{static{l(this,"ProceduralAudioClip")}constructor(t,e={}){this.name=t,this.options={type:"tone",frequency:440,duration:1,volume:.5,sampleRate:44100,fadeIn:.01,fadeOut:.1,...e},this.audioBuffer=null,this.audioContext=null,this._isLoaded=!1}async load(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.audioBuffer=await this.generateAudio(),this._isLoaded=!0,console.log(`ProceduralAudioClip "${this.name}" generated successfully`)}catch(t){throw console.error(`Failed to generate ProceduralAudioClip "${this.name}":`,t),t}}async generateAudio(){let{duration:t,sampleRate:e}=this.options,i=Math.floor(t*e),o=this.audioContext.createBuffer(1,i,e),r=o.getChannelData(0);switch(this.options.type){case"tone":this.generateTone(r,i);break;case"noise":this.generateNoise(r,i);break;case"sweep":this.generateSweep(r,i);break;case"complex":this.generateComplex(r,i);break;case"random":this.generateRandom(r,i);break;default:this.generateTone(r,i)}return this.applyEnvelope(r,i),o}generateTone(t,e){let{frequency:i,sampleRate:o}=this.options,r=this.options.waveType||"sine";for(let n=0;n<e;n++){let a=n/o*i*2*Math.PI;switch(r){case"sine":t[n]=Math.sin(a);break;case"square":t[n]=Math.sin(a)>0?1:-1;break;case"sawtooth":t[n]=2*(a/(2*Math.PI)-Math.floor(a/(2*Math.PI)+.5));break;case"triangle":t[n]=2*Math.abs(2*(a/(2*Math.PI)-Math.floor(a/(2*Math.PI)+.5)))-1;break;default:t[n]=Math.sin(a)}}}generateNoise(t,e){switch(this.options.noiseType||"white"){case"white":for(let o=0;o<e;o++)t[o]=Math.random()*2-1;break;case"pink":this.generatePinkNoise(t,e);break;case"brown":this.generateBrownNoise(t,e);break}}generatePinkNoise(t,e){let i=0,o=0,r=0,n=0,a=0,h=0,c=0;for(let d=0;d<e;d++){let u=Math.random()*2-1;i=.99886*i+u*.0555179,o=.99332*o+u*.0750759,r=.969*r+u*.153852,n=.8665*n+u*.3104856,a=.55*a+u*.5329522,h=-.7616*h-u*.016898,t[d]=i+o+r+n+a+h+c+u*.5362,t[d]*=.11,c=u*.115926}}generateBrownNoise(t,e){let i=0;for(let o=0;o<e;o++){let r=Math.random()*2-1;t[o]=(i+.02*r)/1.02,i=t[o],t[o]*=3.5}}generateSweep(t,e){let i=this.options.startFreq||this.options.frequency,o=this.options.endFreq||this.options.frequency*2,{sampleRate:r}=this.options;for(let n=0;n<e;n++){let a=n/e,h=i+(o-i)*a,c=n/r*h*2*Math.PI;t[n]=Math.sin(c)}}generateComplex(t,e){let{frequency:i,sampleRate:o}=this.options,r=this.options.harmonics||[1,.5,.25,.125];for(let n=0;n<e;n++){let a=0;for(let h=0;h<r.length;h++){let c=i*(h+1),d=n/o*c*2*Math.PI;a+=Math.sin(d)*r[h]}t[n]=a/r.length}}generateRandom(t,e){let i=["tone","noise","sweep"],o=i[Math.floor(Math.random()*i.length)],r={...this.options};switch(this.options.frequency=100+Math.random()*800,this.options.waveType=["sine","square","sawtooth","triangle"][Math.floor(Math.random()*4)],this.options.noiseType=["white","pink","brown"][Math.floor(Math.random()*3)],o){case"tone":this.generateTone(t,e);break;case"noise":this.generateNoise(t,e);break;case"sweep":this.options.startFreq=50+Math.random()*200,this.options.endFreq=200+Math.random()*800,this.generateSweep(t,e);break}this.options=r}applyEnvelope(t,e){let{volume:i,fadeIn:o,fadeOut:r,sampleRate:n}=this.options,a=Math.floor(o*n),h=Math.floor(r*n);for(let c=0;c<e;c++){let d=i;c<a&&(d*=c/a),c>e-h&&(d*=(e-c)/h),t[c]*=d}}isLoaded(){return this._isLoaded&&this.audioBuffer!==null}static meta(t){let i={...s.getDefaultMeta(),...t};if(!i.name||i.name.trim()==="")throw new Error("ProceduralAudioClip metadata must include a valid name");return new s(i.name,i)}static getDefaultMeta(){return{name:"",type:"tone",frequency:440,duration:1,volume:.5,sampleRate:44100,fadeIn:.01,fadeOut:.1,waveType:"sine",noiseType:"white",startFreq:null,endFreq:null,harmonics:[1,.5,.25,.125]}}applyMeta(t){Object.assign(this.options,t),t.name&&(this.name=t.name),this._isLoaded&&(this._isLoaded=!1,this.audioBuffer=null)}toMeta(){return{name:this.name,...this.options}}static createBeep(t=800,e=.2){return s.meta({name:`beep_${t}`,type:"tone",frequency:t,duration:e,waveType:"sine",volume:.3})}static createClick(t=.1){return s.meta({name:"click",type:"noise",duration:t,noiseType:"white",volume:.2,fadeOut:t*.8})}static createWhoosh(t=.5){return s.meta({name:"whoosh",type:"sweep",startFreq:1e3,endFreq:200,duration:t,volume:.4})}static createZap(t=.3){return s.meta({name:"zap",type:"complex",frequency:300,duration:t,harmonics:[1,.8,.6,.4,.2],volume:.5})}static createRandomSFX(t=.5){return s.meta({name:`random_sfx_${Date.now()}`,type:"random",duration:t,volume:.4})}};var Ct=class{static{l(this,"RandomAudioGenerator")}static randomBeep(t={}){let e=t.frequency||200+Math.random()*600,i=t.duration||.1+Math.random()*.3,o=t.waveType||["sine","square","triangle"][Math.floor(Math.random()*3)];return new T(`random_beep_${Date.now()}`,{type:"tone",frequency:e,duration:i,waveType:o,volume:.3+Math.random()*.3,fadeIn:.01,fadeOut:i*.3})}static randomAmbient(t={}){let e=["white","pink","brown"],i=t.noiseType||e[Math.floor(Math.random()*e.length)],o=t.duration||2+Math.random()*8;return new T(`random_ambient_${Date.now()}`,{type:"noise",noiseType:i,duration:o,volume:.1+Math.random()*.2,fadeIn:o*.1,fadeOut:o*.1})}static randomSweep(t={}){let e=t.startFreq||100+Math.random()*500,i=t.endFreq||200+Math.random()*800,o=t.duration||.3+Math.random()*.7,r=Math.random()>.5,n=r?i:e,a=r?e:i;return new T(`random_sweep_${Date.now()}`,{type:"sweep",startFreq:n,endFreq:a,duration:o,volume:.2+Math.random()*.3})}static randomHarmonic(t={}){let e=t.frequency||150+Math.random()*400,i=t.duration||.5+Math.random()*1.5,o=[],r=3+Math.floor(Math.random()*5);for(let n=0;n<r;n++)o.push(Math.random()*(1/(n+1)));return new T(`random_harmonic_${Date.now()}`,{type:"complex",frequency:e,duration:i,harmonics:o,volume:.3+Math.random()*.2})}static randomPercussion(t={}){let e=t.duration||.05+Math.random()*.15,i=["noise","tone"],o=i[Math.floor(Math.random()*i.length)],r={duration:e,volume:.4+Math.random()*.4,fadeIn:.001,fadeOut:e*.7};return o==="noise"?new T(`random_percussion_${Date.now()}`,{...r,type:"noise",noiseType:"white"}):new T(`random_percussion_${Date.now()}`,{...r,type:"tone",frequency:80+Math.random()*200,waveType:"square"})}static randomNote(t={}){let e=[261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25,554.37,587.33,622.25,659.25,698.46,739.99,783.99,830.61,880,932.33,987.77],i=t.frequency||e[Math.floor(Math.random()*e.length)],o=t.duration||.5+Math.random()*1,r=t.waveType||["sine","triangle"][Math.floor(Math.random()*2)];return new T(`random_note_${Date.now()}`,{type:"tone",frequency:i,duration:o,waveType:r,volume:.3+Math.random()*.3,fadeIn:.05,fadeOut:o*.2})}static randomLaser(t={}){let e=t.startFreq||400+Math.random()*600,i=t.endFreq||50+Math.random()*200,o=t.duration||.2+Math.random()*.3;return new T(`random_laser_${Date.now()}`,{type:"sweep",startFreq:e,endFreq:i,duration:o,volume:.4+Math.random()*.3,fadeOut:o*.5})}static randomPickup(t={}){return new T(`random_pickup_${Date.now()}`,{type:"complex",frequency:600+Math.random()*400,duration:.3+Math.random()*.2,harmonics:[1,.6,.3,.1],volume:.4+Math.random()*.2,fadeOut:.15})}static randomExplosion(t={}){let e=t.duration||.5+Math.random()*1;return new T(`random_explosion_${Date.now()}`,{type:"noise",noiseType:"brown",duration:e,volume:.5+Math.random()*.3,fadeIn:.01,fadeOut:e*.6})}static randomAny(t={}){let e=[this.randomBeep,this.randomSweep,this.randomHarmonic,this.randomPercussion,this.randomNote,this.randomLaser,this.randomPickup];return e[Math.floor(Math.random()*e.length)].call(this,t)}static randomSequence(t=5,e={}){let i=[];for(let o=0;o<t;o++)i.push(this.randomAny(e));return i}static createVariations(t,e=3,i={}){let o=[],r=`random${t.charAt(0).toUpperCase()+t.slice(1)}`;if(typeof this[r]=="function")for(let n=0;n<e;n++)o.push(this[r](i));else{console.warn(`Unknown sound type: ${t}`);for(let n=0;n<e;n++)o.push(this.randomAny(i))}return o}};export{ot as AudioClip,_ as AudioListenerComponent,vt as AudioSourceComponent,yt as BoxColliderComponent,G as CameraComponent,V as CircleColliderComponent,p as Component,At as Destroy,$t as DestroyAll,Ot as DestroyComponent,bt as FollowTarget,m as Game,F as GameObject,mt as ImageComponent,M as Input,P as Instantiate,j as LayerManager,rt as MonoBehaviour,st as MovementComponent,dt as MovementController,T as ProceduralAudioClip,wt as Random,Ct as RandomAudioGenerator,Z as RigidbodyComponent,ct as Scene,ft as ShapeComponent,at as SpriteAnimationClip,ht as SpriteAnimationComponent,ut as SpriteAsset,C as SpriteRegistry,K as SpriteRendererComponent,pt as SpritesheetAsset,$ as Tile,it as TileAsset,I as TileRegistry,gt as TilemapComponent,v as Time,y as Vector2,Mt as Vector3,qt as clearPendingDestructions,jt as getPendingDestructionCount};
